!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("FDBLib"),require("FDBLib").Components):"function"==typeof define&&define.amd?define("fortressdb",["FDBLib"],t):"object"==typeof exports?exports.fortressdb=t(require("FDBLib"),require("FDBLib").Components):e.fortressdb=t(e.FDBLib,e.FDBLib.Components)}(self,(function(e,t){return(()=>{"use strict";var n,r={4534:(e,t,n)=>{n.r(t),n.d(t,{App:()=>r,Coupon:()=>be,DataChart:()=>Ie,DataTable:()=>Xt,Endpoint:()=>T.F,HttpRequest:()=>A.a,Layout:()=>ie,NameForm:()=>on,OptionsList:()=>y.OptionsList,PageHeader:()=>vn,Price:()=>y.Price,Property:()=>gn,SelectPicklist:()=>Nn,SelectTable:()=>In,SortableList:()=>Mn,TariffPlan:()=>Yn,TypeControl:()=>rr,Watcher:()=>U,blocks:()=>s,file:()=>fl,socket:()=>F.W});var r={};n.r(r),n.d(r,{Component:()=>ne,Context:()=>te,Provider:()=>ee});var a={};n.r(a),n.d(a,{Edit:()=>la,Save:()=>sa,View:()=>ba,className:()=>ia});var o={};n.r(o),n.d(o,{Edit:()=>Ia,Save:()=>qa,View:()=>Va,className:()=>Aa});var c={};n.r(c),n.d(c,{Edit:()=>$a,Save:()=>Qa,View:()=>No,className:()=>Xa});var l={};n.r(l),n.d(l,{Edit:()=>tc,Save:()=>rc,View:()=>vc,className:()=>nc});var i={};n.r(i),n.d(i,{CustomDataClassName:()=>Lc,CustomDataEdit:()=>Rc,CustomDataSave:()=>zc,CustomDataView:()=>tl,TemplateEdit:()=>sl,TemplateSave:()=>ul});var s={};n.r(s),n.d(s,{chart:()=>o,custom_data:()=>i,map:()=>l,price:()=>c,table:()=>a});var u=n(4942),f=n(5671),p=n(3144),m=n(9340),d=n(2963),b=n(1120);const v=window.wp.element;var y=n(4076),g=n(885),h=n(9196),E=n.n(h),w=n(5861);const k=window.regeneratorRuntime;var O,x,N,C=n.n(k),j=n(9470),S=y.Utils.applyDiscount,P=(O=6e4*(new Date).getTimezoneOffset(),x=0===O,N=/\.\d+Z$/,function(e){if(!e)return"";try{return(e=x?e:new Date(new Date(e).getTime()-O).toISOString()).replace(N,"")}catch(e){}return e});function Z(e){var t=e%60,n=e/60>>0,r=n%60,a=n/60>>0,o=a<10?"0".concat(a):"".concat(a),c=r<10?"0".concat(r):"".concat(r),l=t<10?"0".concat(t):"".concat(t);return"".concat(o,":").concat(c,":").concat(l)}function _(e){switch(e){case"string":case"text":case"json":case"uuid":return String();case"integer":case"float":return Number();case"boolean":return Boolean();case"date":case"datetime":return(new Date).toISOString();case"time":case"enum":return 0;case"file":return null}}var D=n(312),T=n(2361),I=n(9187),A=n(5716),q=(y.Utils.isDoubleTouch,y.Constants.LOCATIONS),B=y.Constants.DEFAULT_LOCATION,F=(y.Utils.renderDOM,n(2092)),M=y.Utils.loadStripe,R=y.Utils.useDictionary;n.g.fdbLocale=n.g.fortressdbUserLocale;var L=y.Utils.usePrevious,V=y.Utils.usePromise,z=y.Utils.useTimeout;var U=function(e){(0,m.Z)(a,e);var t,n,r=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,b.Z)(t);if(n){var a=(0,b.Z)(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return(0,d.Z)(this,e)});function a(e){return(0,f.Z)(this,a),r.call(this,e,F.W)}return(0,p.Z)(a)}(j.Watcher),H=new T.F("options");function W(e){var t=(0,h.useContext)(y.App.Context),r=(t.state.options,t.dispatch),a=(0,h.useState)(!1),o=(0,g.Z)(a,2),c=o[0],l=o[1],i=(0,h.useRef)({optionsRequest:function(){return(0,w.Z)(C().mark((function e(){var t,n;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H.get().json();case 3:t=e.sent,r({options:t}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),n=e.t0.message,r({error:n});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()}}).current;return(0,h.useEffect)((function(){n.g.fortressdbInitialOptions?(r({options:n.g.fortressdbInitialOptions}),l(!0)):(0,w.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({fetching:!0}),l(!0),e.prev=2,e.next=5,i.optionsRequest();case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:r({fetching:!1});case 10:case"end":return e.stop()}}),e,null,[[2,7]])})))(),F.W.authenticate().then((function(){F.W.on("authenticate",i.optionsRequest)})).catch((function(){}))}),[]),c?e.children:null}function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=new U("licenses");function G(e){var t=(0,h.useContext)(y.App.Context),r=t.state,a=t.dispatch,o=(0,h.useRef)({updateLicenses:function(e,t){if(t)a({error:t.message});else{var n=e.license,r=n.usedResources,o=void 0===r?[]:r,c=n.plan,l=void 0===c?"FREE":c,i=n.status,s=n.expired,u=n.discount,f=e.plans,p=void 0===f?[]:f,m=p.find((function(e){return(e.period||[]).find((function(e){return e.id===l}))}));if(m){var d=m.period.find((function(e){return e.id===l})),b={plans:p,currentPlanId:l,currentPlanData:m,currentPeriod:d,price:d.price,discount:u,status:i,expired:s,usedResources:o,resources:m.restrictions.map((function(e){var t=o.find((function(t){return e.name===t.name}));return t?-1!==e.value?Y(Y({},e),{},{allow:-1!==t.value||e.value<t.value,limit:e.value,value:t.value}):Y(Y({},e),{},{allow:!0,value:t.value}):Y(Y({},e),{},{allow:!0})}))};a({license:b})}}}}),c=o.current,l=r.options||{},i=l.connected,s=l.email,u=l.useCustomServer,f=l.location,p=(r||{}).license;return(0,h.useEffect)((function(){p&&"free"!=p.currentPlanData.name&&(0,w.Z)(C().mark((function e(){var t,r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.W.get("stripe_portal-link",{return_url:n.g.location.href});case 3:t=e.sent,r=t.url,a({billingPortalUrl:r}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}),[p]),(0,h.useEffect)((function(){if(i)return(0,w.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a({fetching:!0}),e.prev=1,e.next=4,K.subscribe({context:{email:s,location:u?"custom":f}},c.updateLicenses);case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),t=e.t0.message,a({error:t});case 10:a({fetching:!1});case 11:case"end":return e.stop()}}),e,null,[[1,6]])})))(),function(){K.unsubscribe()}}),[i,s,u,f]),e.children}function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t){return X(X({},e),t)}function ee(e){var t=e.children,n=e.license,r=void 0!==n&&n,a=(0,h.useReducer)(Q,{}),o=(0,g.Z)(a,2),c=o[0],l=o[1],i=(0,h.useMemo)((function(){return{state:c,dispatch:l}}),[c]);return(0,v.createElement)(y.App.Context.Provider,{value:i},(0,v.createElement)(W,null,r?(0,v.createElement)(G,null,t):t))}ee.displayName="Provider";var te=y.App.Context,ne=y.App.Component,re=n(7462),ae=n(4925),oe=["type","className","children","style"],ce=E().useMemo,le={none:"fortressdb-layout-none",block:"fortressdb-layout-block",row:"fortressdb-layout-row",col:"fortressdb-layout-col",align:"fortressdb-layout-align",left:"fortressdb-layout-left",right:"fortressdb-layout-right",top:"fortressdb-layout-top",bottom:"fortressdb-layout-bottom",horizontal:"fortressdb-layout-horizontal",vertical:"fortressdb-layout-vertical",space:"fortressdb-layout-space",between:"fortressdb-layout-between",around:"fortressdb-layout-around",evenly:"fortressdb-layout-evenly",flex:"fortressdb-layout-flex",fill:"fortressdb-layout-fill",content:"fortressdb-layout-content",wrap:"fortressdb-layout-wrap",ellipsis:"fortressdb-layout-ellipsis",scroll:"fortressdb-layout-scroll",background:"fortressdb-layout-background",contain:"fortressdb-layout-contain",relative:"fortressdb-layout-relative",absolute:"fortressdb-layout-absolute",fixed:"fortressdb-layout-fixed"},ie=E().forwardRef((function(e,t){var n=e.type,r=e.className,a=e.children,o=e.style,c=(0,ae.Z)(e,oe),l=ce((function(){return(n||"").split(" ").map((function(e){return e.trim()})).map((function(e){return e&&le[e]})).concat([r]).filter((function(e){return e})).join(" ")}),[n,r]);return(0,v.createElement)("div",(0,re.Z)({ref:t,className:l,style:o||{}},c),a)})),se=E().useEffect,ue=E().useState,fe=E().useRef,pe=E().useCallback,me=E().useContext,de="fortressdb-component-coupon";function be(e){var t=e.onDiscount,n=e.onFetching,r=ue(!1),a=(0,g.Z)(r,2),o=a[0],c=a[1],l=ue(""),i=(0,g.Z)(l,2),s=i[0],u=i[1],f=me(te).state.options,p=z(),m=p.setTimeout,d=p.clearTimeout,b=fe({timeout:null}).current,h=f.useCustomServer,E=f.location,k=pe(function(){var e=(0,w.Z)(C().mark((function e(r){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b.timeout&&(d(b.timeout),b.timeout=null),b.timeout=m((0,w.Z)(C().mark((function e(){var a;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=3;break}return t&&t(null),e.abrupt("return");case 3:return c(!0),n&&n(!0),e.prev=5,e.next=8,F.W.get("coupons",{filter:{id:r,location:h?"custom":E}});case 8:a=e.sent,t&&t(a),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),t&&t(null);case 15:c(!1),n&&n(!1);case 17:case"end":return e.stop()}}),e,null,[[5,12]])}))),500);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);se((function(){u(e.code||"")}),[e.code||""]),se((function(){k(s)}),[s]);var O=pe(function(){var e=(0,w.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u(t.target.value.trim());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),x=R();return(0,v.createElement)("div",{className:de},(0,v.createElement)("div",{className:"".concat(de,"__icon-wrapper"),title:x("coupon")},(0,v.createElement)(y.Icon,{color:"white",icon:"label"})),(0,v.createElement)(y.Input,{value:s,onChange:O,placeholder:x("enter-code-here")}),o&&(0,v.createElement)(y.Spinner,null))}be.displayName="Coupon";var ve=n(2982),ye=n(1002),ge=n(8446),he=n.n(ge);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ke=E().useCallback,Oe=E().useState,xe=E().useEffect,Ne=E().useMemo,Ce=(E().useRef,E().Fragment),je=["string","enum"],Se=["date"],Pe=["integer","float"];function Ze(e){var t=(e||{}).type;switch(!0){case Pe.indexOf(t)>=0:return"number";case je.indexOf(t)>=0:return"string";case Se.indexOf(t)>=0:return"datetime"}}function _e(e,t){var n=t.fields.find((function(t){return t.name===e}));return n?n.name:e}var De=new U("objects"),Te=new U("enum_values");function Ie(e){var t=e.chart,n=e.dataSettings,r=e.table,a=e.page,o=e.onTotalCountChange,c=void 0===o?function(e){}:o,l=Oe(!1),i=(0,g.Z)(l,2),s=i[0],u=i[1],f=Oe(null),p=(0,g.Z)(f,2),m=p[0],d=p[1],b=Oe(null),h=(0,g.Z)(b,2),E=h[0],w=h[1],k=Oe({}),O=(0,g.Z)(k,2),x=O[0],N=O[1],C=n.perPage,S=void 0===C?10:C,P=ke((function(e,t){t?d(t.message):(w(e),d(null))}),[]),Z=ke((function(e,t){t?d(t.message):(N(Object.keys(e).reduce((function(t,n){return t[n]=e[n].rows,t}),{})),d(null))}),[]),_=(r||{}).tableName,D=L(n),T=L(_),I=L(a),A=Ne((function(){if(E&&n&&r)return function(e,t,n,r){var a=t.x,o=t.y,c=[a].concat((0,ve.Z)(o)).map((function(e){return e&&n.find((function(t){return t.name===e}))})).filter((function(e){return e})).map((function(e){return we({name:e.name,type:Ze(e),caption:e.extend.caption},"enum"===e.type?{enumId:e.extend.enumId}:{})})).filter((function(e){return e.type})),l=[];return e.forEach((function(e){var t=[];c.forEach((function(n){var a=n.name,o=n.type,c=n.enumId;t.push(function(e,t,n,r){switch(t){case"datetime":if("object"!==(0,ye.Z)(e))return new Date(e);break;case"number":if("number"!=typeof e)return Number(e);break;case"string":if(n){var a=e?Array.isArray(e)?e:[e]:[],o=(r||{})[n]||[];return a.map((function(e){return(o.find((function(t){return t.id===e}))||{}).label||e})).join(", ")||String(e)}if("string"!=typeof e)return String(e)}return e}(e[a],o,c,r))})),l.push(t)})),{cols:c.map((function(e){return{type:e.type,caption:e.caption}})),rows:l}}(E,n,r.fields,x)}),[E,n,r,x]);return xe((function(){if(_&&n&&(_!==T||!he()(n,D)||I!=a)){var e=n.x,t=n.y,o=n.order,c=n.group;if(!e||!t.length)return;u(!0),w(null);var l=_e(e,r);if(De.subscribe({context:{tableName:_},filter:we(we(we({},o?{order:[j.query.orderBy(l,o)]}:c?{order:[j.query.orderBy(j.query.fn("min","id").as("id"))]}:{order:[j.query.orderBy("id")]}),c?{attributes:[j.query.col(l).as(e)].concat((0,ve.Z)(t.map((function(e){return j.query.fn(c,_e(e,r)).as(e)})))),group:[l]}:{attributes:[j.query.col(l).as(e)].concat((0,ve.Z)(t.map((function(e){return j.query.col(_e(e,r)).as(e)}))))}),{},{limit:S,offset:a*S}),raw:!0},P).catch((function(e){d(e.message)})).finally((function(){u(!1)})),_!==T){Te.unsubscribe();var i=r.fields.filter((function(e){return"enum"===e.type})).map((function(e){return e.extend.enumId}));i.length&&Te.subscribe({context:{enumId:i}},Z).catch((function(e){d(e.message)}))}}})),xe((function(){if(_&&n&&(_!==T||!he()(n,D))){var e=n.x,t=n.group,a=_e(e,r);De.subscribe({context:{tableName:_},filter:we({},t?{attributes:[j.query.fn("count",j.query.lit("distinct ".concat(a))).as("count")]}:{attributes:[j.query.fn("count",a).as("count")]}),raw:!0},(function(e){var t=(e||[]).reduce((function(e,t){return e+t.count}),0);c(t)})).catch((function(e){return console.error("Err",e)}))}})),xe((function(){return function(){De.unsubscribe(),Te.unsubscribe()}}),[]),!!r&&(0,v.createElement)(Ce,null,(0,v.createElement)(y.Notify,{message:m,onClear:function(){return d(null)}}),(0,v.createElement)(y.Chart,{chart:t,dataTable:A}),s&&(0,v.createElement)(y.Spinner,null))}Ie.displayName="DataChart";var Ae=E().useMemo;function qe(e){var t=e.field,n=e.value,r=e.changeValue,a=e.disabled,o=t.type,c=t.name,l=t.extend,i=l.caption,s=l.enumId,u=l.isMandatory,f=l.isMultiple,p=l.placeholder,m=Ae((function(){return"enum"===o&&e.enumsValues&&e.enumsValues[s]?function(e,t,n,r){if(t){var a=e[t].map((function(e){return{label:e.label,value:e.id}}));return n||r?a:[{label:"None",value:0}].concat((0,ve.Z)(a))}}(e.enumsValues,s,u,f):[]}),[e.enumsValues,s,u,f]);return(0,v.createElement)(gn,{disabled:a,key:c,title:i,type:o,isMandatory:u,isMultiple:f,placeholder:p,options:"enum"===o?m:t.options,value:n,changeValue:r})}qe.displayName="FieldProperty";var Be=n(9734),Fe=n.n(Be);const Me=window.moment;var Re=n.n(Me),Le=n(4184),Ve=n.n(Le);function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=y.Tabs.Contents,We=y.Tabs.Tag,Je=y.Tabs.Page,Ye=E().useState,Ke=E().useContext,Ge=E().useEffect,$e=E().useMemo,Xe=E().useRef,Qe=E().useCallback,et="fortressdb-component-data-table",tt=new U("revisions");function nt(e){var t=Ye(!1),n=(0,g.Z)(t,2),r=n[0],a=n[1],o=Ye(null),c=(0,g.Z)(o,2),l=c[0],i=c[1],s=e.onError,f=void 0===s?function(e){console.error(e),i(e)}:s,p=e.table,m=Ye([]),d=(0,g.Z)(m,2),b=d[0],h=d[1],E=Ke(te).state.license,k=Ye("current"),O=(0,g.Z)(k,2),x=O[0],N=O[1],S=Ye(p.fields||[]),P=(0,g.Z)(S,2),Z=P[0],D=P[1],T=Ye({}),I=(0,g.Z)(T,2),A=I[0],q=I[1];function B(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];q(Z.reduce((function(n,r){var a=r.name,o=e[a];return Ue(Ue({},n),{},(0,u.Z)({},a,t||void 0===o?void 0!==r.defaultValue?r.defaultValue:_(r.type):o))}),{}))}Ge((function(){D(p.fields.filter((function(e){return!e.extend.isHidden})))}),[p.fields]),Ge((function(){B(e.object||{},e.new)}),[]);var F=Xe({updateRevisions:function(e,t){if(t)f(t.message);else{var n=e.rows;h(n)}}}),M=F.current;Ge((function(){if(e.object&&e.object.id)return tt.subscribe({filter:{order:[j.query.orderBy("id",j.query.DESC)]},context:{tableName:p.tableName,objectId:e.object.id}},M.updateRevisions).catch((function(e){f(e.message)})),function(){tt.unsubscribe()}}),[e.object&&e.object.id]);var L=Ke(y.Popup.Context),V=R(),z=Qe((0,w.Z)(C().mark((function t(){return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a(!0),t.prev=1,!e.new){t.next=7;break}return t.next=5,e.endpoint.post([A]);case 5:t.next=9;break;case 7:return t.next=9,e.endpoint.put([A]);case 9:L(),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),f(t.t0.message),a(!1);case 16:case"end":return t.stop()}}),t,null,[[1,12]])}))),[A,L]),U=$e((function(){return Fe()(Z.filter((function(e){return!e.extend.isHidden})),"extend.order")}),[Z]),H=Qe((function(e,t){q(Ue(Ue({},A),{},(0,u.Z)({},e,t)))}),[Z,A]),W=$e((function(){return U.filter((function(e){return!e.extend.isSystem}))}),[U]),J=$e((function(){return U.filter((function(e){return e.extend.isSystem}))}),[U]),Y=$e((function(){return!!E.resources&&E.resources.find((function(e){return"revisions"===e.name})).allow}),[E]),K=[{value:"current",label:V("current")}].concat((0,ve.Z)(b.map((function(e){var t=e.updatedAt;return{value:t,label:b.some((function(e){return Re()(e.updatedAt).format("DD MMM YYYY")===Re()(t).format("DD MMM YYYY")}))?Re()(t).format("DD MMM YYYY, hh:mm:ss"):Re()(t).format("DD MMM YYYY")}}))));return(0,v.createElement)(ie,{type:"col relative",className:Ve()("".concat(et,"__object-fields"),"fortressdb-form","fortressdb-form-fields")},(0,v.createElement)(y.Notify,{wide:!0,message:l,onClear:function(){return i(null)}}),(0,v.createElement)(y.Tabs.Component,{defaultTab:"custom"},(0,v.createElement)(He,null,(0,v.createElement)(We,{tabId:"custom"},V("custom-fields")),(0,v.createElement)(We,{tabId:"system"},V("system-fields"))),(0,v.createElement)(Je,{tabId:"custom",className:"fortressdb-form-fields-tab"},W.length?W.map((function(t){return(0,v.createElement)(qe,{enumsValues:e.enumsValues||{},key:t.name,field:t,value:A[t.name],changeValue:function(e){return H(t.name,e)}})})):(0,v.createElement)(y.Empty,{message:V("no-fields")})),(0,v.createElement)(Je,{tabId:"system",className:"fortressdb-form-fields-tab"},J.map((function(e){return(0,v.createElement)(qe,{field:e,key:e.name,disabled:!0,value:A[e.name],changeValue:function(t){return H(e.name,t)}})})))),(0,v.createElement)(ie,{type:"row",className:"fortressdb-form-controls"},(0,v.createElement)(y.Button,{onClick:z,disabled:e.disabled},V("save")),(0,v.createElement)(y.Button,{onClick:L},V("cancel")),Y&&!e.new&&b.length?(0,v.createElement)(ie,{type:"row flex align right",className:"".concat(et,"__object-fields-revisions")},(0,v.createElement)(y.Select,{options:K,value:K.find((function(e){return e.value===x})),onChange:function(t){var n=t.value;N(n),B("current"!==n?b.find((function(e){return e.updatedAt===n})):Ue({},e.object||{}))}})):null),r&&(0,v.createElement)(y.Spinner,null))}nt.displayName="ObjectFields";var rt=E().useState,at=E().useContext,ot=E().useCallback;function ct(e){var t=rt(!1),n=(0,g.Z)(t,2),r=n[0],a=n[1],o=rt(null),c=(0,g.Z)(o,2),l=c[0],i=c[1],s=at(y.Popup.Context),u=R(),f=ot((0,w.Z)(C().mark((function t(){return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a(!0),t.prev=1,t.next=4,e.endpoint.delete({where:{id:e.selected}});case 4:s(),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(1),i(t.t0.message),a(!1);case 11:case"end":return t.stop()}}),t,null,[[1,7]])}))),[]),p=e.selected.map((function(t){var n=e.objects.find((function(e){return e.id===t}));return n?"ID=".concat(n.id):""})).filter((function(e){return!!e})).join(", ");return(0,v.createElement)(ie,{type:"col relative",className:"fortressdb-form"},(0,v.createElement)(y.Notify,{message:l,onClear:function(){return i(null)}}),(0,v.createElement)(ie,{type:"row"},u("confirm-remove-selected-objects"),(0,v.createElement)("span",{style:{marginLeft:"0.5em"}},"[ ",p," ]")),(0,v.createElement)(ie,{type:"row",className:"fortressdb-form-controls"},(0,v.createElement)(y.Button,{onClick:f,disabled:e.disabled},u("confirm")),(0,v.createElement)(y.Button,{onClick:s},u("cancel"))),r&&(0,v.createElement)(y.Spinner,null))}ct.displayName="ObjectRemove";var lt=n(3671);function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function st(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ut=E().useState,ft=E().useContext,pt=E().useCallback,mt=E().useEffect,dt=E().useMemo,bt="fortressdb-component-data-table";function vt(e){var t=e.table,n=ut(!1),r=(0,g.Z)(n,2),a=r[0],o=r[1],c=ut(null),l=(0,g.Z)(c,2),i=l[0],s=l[1],u=ut(null),f=(0,g.Z)(u,2),p=f[0],m=f[1],d=ut(""),b=(0,g.Z)(d,2),h=b[0],E=b[1],k=ut(","),O=(0,g.Z)(k,2),x=O[0],N=O[1],j=ut([]),S=(0,g.Z)(j,2),P=S[0],Z=S[1],_=ut(!0),D=(0,g.Z)(_,2),T=D[0],I=D[1],A=ut(!1),q=(0,g.Z)(A,2),B=q[0],M=q[1],L=ut([]),V=(0,g.Z)(L,2),z=V[0],U=V[1],H=ft(y.Popup.Context),W=R(),J=pt((0,w.Z)(C().mark((function e(){var n,r,a;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.prev=1,n=t.tableName,r=z.reduce((function(e,t){return e[t.id]=t.index,e}),{}),a=p&&Array.isArray(p)?p[0]:p,e.next=7,F.W.post("objects-import",{context:{tableName:n},data:[{fieldsMapping:r,delimiter:x,clearTable:B,hasHeader:T,file:a}]});case 7:H(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),s(e.t0.message),o(!1);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),[t,p,z,x,T,B]);mt((function(){var e=p&&Array.isArray(p)?p[0]:p;if(e){var t=new FileReader;t.addEventListener("load",(function(e){var t=(e.target.result||"").split("\n")[0].trim(),n=t.indexOf(";")>=0?";":",";E(t),N(n)})),t.readAsText(e.slice(0,Math.min(e.size,1024)))}}),[p]),mt((function(){x&&lt({output:"csv",noheader:!0,delimiter:x}).fromString(h||"").then((function(e){return(e[0]||[]).map((function(e){return e.replace(/^["\s]+|["\s]+$/,"")}))})).then((function(e){var n=e.map((function(e,t){return{value:t,label:"[".concat(t,"] ").concat(e)}}));Z([{value:-1,label:"None"}].concat((0,ve.Z)(n))),t&&U(t.fields.filter((function(e){var t=e.extend,n=t.isSystem,r=t.isHidden;return!n&&!r})).sort((function(e,t){return e.extend.order-t.extend.order})).map((function(t){var n=t.name,r=t.extend.caption;return{id:n,caption:r,index:e.findIndex((function(e){return e===r}))}})))}))}),[t,h,x]);var Y=dt((function(){return[{Header:"Column",accessor:"caption"},{Header:"Index",accessor:"index",Cell:function(e){var t=e.original,n=e.value,r=e.index;return(0,v.createElement)(y.Select,{options:P,value:P.find((function(e){return e.value===n})),onChange:function(e){var n=(0,ve.Z)(z);n.splice(r,1,st(st({},t),{},{index:e.value})),U(n)}})}}]}),[P,z]);return(0,v.createElement)(ie,{type:"col relative",className:"".concat(bt,"__import-file")},(0,v.createElement)(y.Notify,{message:i,onClear:function(){return s(null)}}),a&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(ie,{type:"col"},(0,v.createElement)(ie,{type:"col",style:{marginBottom:"4px"}},W("select-file"),(0,v.createElement)(rr,{field:{type:"file",value:p},changeValue:m,acceptFiles:".csv, text/csv"})),(0,v.createElement)(ie,{type:"row",style:{marginBottom:"4px"}},(0,v.createElement)(ie,{type:"col"},W("delimiter"),(0,v.createElement)(y.Input,{value:x,onChange:function(e){var t=e.target.value;N(t)},maxLength:1,style:{width:"4em"}})),(0,v.createElement)(ie,{type:"col flex align bottom",style:{marginLeft:"2em"}},(0,v.createElement)(ie,{type:"row",style:{marginBottom:"4px"}},(0,v.createElement)(y.Input,{type:"checkbox",checked:T,onChange:function(e){var t=e.target.checked;I(t)}}),W("has-header")),(0,v.createElement)(ie,{type:"row"},(0,v.createElement)(y.Input,{type:"checkbox",checked:B,onChange:function(e){var t=e.target.checked;M(t)}}),W("clear-table")))),(0,v.createElement)(ie,{type:"col"},(0,v.createElement)("b",null,W("map-columns")),(0,v.createElement)(y.Table,{data:z,columns:Y,pageSize:z.length||5,filterable:!1,sortable:!1,showPagination:!1,manual:!1}))),(0,v.createElement)("div",{className:"".concat(bt,"__popup-buttons")},(0,v.createElement)(y.Button,{onClick:J,disabled:e.disabled||!p||!x},W("upload")),(0,v.createElement)(y.Button,{onClick:H},W("cancel"))))}function yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}vt.displayName="ImportFile";var ht=E().useState,Et=E().useContext,wt=E().useCallback;function kt(e){var t=e.table,n=e.filter,r=ht(!1),a=(0,g.Z)(r,2),o=a[0],c=a[1],l=ht(null),i=(0,g.Z)(l,2),s=i[0],u=i[1],f=ht(","),p=(0,g.Z)(f,2),m=p[0],d=p[1],b=ht("utf8"),h=(0,g.Z)(b,2),E=h[0],k=h[1],O=ht(!1),x=(0,g.Z)(O,2),N=x[0],j=x[1],S=Et(y.Popup.Context),P=R(),Z=wt((0,w.Z)(C().mark((function e(){var r,a;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,e.next=4,new Promise((function(e,r){F.W.once("exportFinished",(function(t,n){n("OK"),e(t)}));var a=gt({attributes:t.fields.filter((function(e){return!e.extend.isHidden})).sort((function(e,t){return e.extend.order-t.extend.order})).map((function(e){var t=e.name,n=e.type,r=e.extend.caption;return{column:"enum"!==n?t:"".concat(t,"_label"),alias:r}}))},N&&n||{});delete a.limit,delete a.offset,F.W.get("objects-export",{context:{tableName:t.tableName,extendByEnums:!0},filter:a,options:{delimiter:m,encoding:E}})}));case 4:if(r=e.sent,!(a=r.uuid)){e.next=11;break}return e.next=9,(0,D.S)({uuid:a},"".concat(t.name,".csv"),!0);case 9:e.next=12;break;case 11:throw new Error(r.message);case 12:S(),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),u(e.t0.message),c(!1);case 19:case"end":return e.stop()}}),e,null,[[1,15]])}))),[t,n,m,N,E]);return(0,v.createElement)(ie,{type:"col relative"},(0,v.createElement)(y.Notify,{message:s,onClear:function(){return u(null)}}),o&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(ie,{type:"col"},(0,v.createElement)(ie,{type:"row"},(0,v.createElement)(y.Input,{type:"checkbox",checked:N,onChange:function(e){var t=e.target.checked;j(t)}}),P("use-filter")),(0,v.createElement)(ie,{type:"row",style:{marginBottom:"4px"}},(0,v.createElement)(ie,{type:"col"},P("delimiter"),(0,v.createElement)(y.Input,{value:m,onChange:function(e){var t=e.target.value;d(t)},maxLength:1,style:{width:"4em"}})),(0,v.createElement)(ie,{type:"col",style:{marginLeft:"2em"}},P("encoding"),(0,v.createElement)(y.Input,{value:E,onChange:function(e){var t=e.target.value;k(t)},maxLength:1,style:{width:"4em"}})))),(0,v.createElement)("div",{className:"".concat("fortressdb-component-data-table","__popup-buttons")},(0,v.createElement)(y.Button,{onClick:Z,disabled:e.disabled||o},P("download")),(0,v.createElement)(y.Button,{onClick:S},P("cancel"))))}kt.displayName="ExportFile";var Ot=[5,10,15,20,50,100],xt=[{id:"id",desc:!1}];function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var jt={Cell:void 0,Filter:void 0,Header:"",id:void 0,width:200};function St(e){var t=e.value;return(0,v.createElement)("div",null,Object.keys(t).map((function(e){return(0,v.createElement)("div",{key:e}," ",e+" : "+t[e]," ")})))}St.displayName="termRenderer";var Pt=(0,p.Z)((function e(){(0,f.Z)(this,e)}));(0,u.Z)(Pt,"prefix","search_"),(0,u.Z)(Pt,"tableColumns",[Ct(Ct({},jt),{},{Header:"Id",id:"id",accessor:"id",width:60}),Ct(Ct({},jt),{},{Header:"Search term",id:"searchTerm",accessor:function(e){return e.searchTerm},Cell:St,width:400}),Ct(Ct({},jt),{},{Header:"Count",id:"count",accessor:"count"}),Ct(Ct({},jt),{},{Header:"Created At",id:"createdAt",accessor:function(e){return new Date(e.createdAt).toLocaleDateString()+" "+new Date(e.createdAt).toLocaleTimeString()}}),Ct(Ct({},jt),{},{Header:"Updated At",id:"updatedAt",accessor:function(e){return new Date(e.updatedAt).toLocaleDateString()+" "+new Date(e.updatedAt).toLocaleTimeString()}})]),(0,u.Z)(Pt,"tableFields",[{name:"id",type:"integer"},{name:"searchTerm",type:"json"},{name:"count",type:"integer"},{name:"createdAt",type:"datetime"},{name:"updatedAt",type:"datetime"}]),(0,u.Z)(Pt,"metadata",{tableName:"Search history",fields:Pt.tableFields});const Zt=Pt;function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tt=E().useCallback,It=E().useState,At=E().useEffect,qt=E().useContext,Bt=E().useMemo,Ft=E().useRef,Mt=E().Fragment,Rt="fortressdb-component-data-table",Lt=/([><=!]+)[\s]*?|([-]?\d+[.,]?\d?)[\s]*?|([|&]+|and|or)/g,Vt={"=":"=","!=":"!=","<>":"!=","<":"<","<=":"<=",">":">",">=":">="},zt="or",Ut="and",Ht={or:zt,"|":zt,"||":zt,and:Ut,"&":Ut,"&&":Ut};function Wt(e,t){var n=e.page,r=e.pageSize,a=e.sorted,o=void 0===a?[]:a,c=e.filtered,l=void 0===c?[]:c,i=t.fields,s={order:o.reduce((function(e,t){var n=t.id,r=t.desc,a=i.find((function(e){return e.name===n}));if(!a)return e;if(a){if("json"===a.type)return e.push(j.query.orderBy(j.query.fn("coalesce",j.query.fn("cast",n,j.query.lit("text")),j.query.val("")),r?j.query.DESC:j.query.ASC)),e;e.push(j.query.orderBy(n,r?j.query.DESC:j.query.ASC))}return e}),[]),limit:r,offset:n*r};if(l.length){var u=l.reduce((function(e,t){var n=t.id,r=t.value,a=i.find((function(e){return e.name===n}));if(!a)return e;if(a){switch(a.type){case"string":case"text":return e.push(j.query.op("iLike",n,j.query.val("%".concat(r,"%")))),e;case"integer":case"float":return e.push(function(e,t){var n=(0,ve.Z)(t.matchAll(Lt)).map((function(e){return e[0]}));if(n.length){var r=n.map((function(e,t){var n=Vt[e];return n?{type:"math",operator:n,index:t}:(n=Ht[e])?{type:"logic",operator:n,index:t}:{type:"number",number:+e.replace(",","."),index:t}}));if(1===r.length&&"number"===r[0].type)return j.query.op("iLike",j.query.fn("coalesce",j.query.fn("cast",e,j.query.lit("text")),j.query.val("")),j.query.val("%".concat(r[0].number,"%")));if(2===r.length&&"math"===r[0].type&&"number"===r[1].type)return j.query.op(r[0].operator,e,j.query.val(r[1].number));var a=r.filter((function(e){return"logic"===e.type})).filter((function(e){return e.operator===zt})).reduce((function(e,t,n,a){return 0===n?e.push(r.slice(0,t.index)):e.push(r.slice(a[n-1].index+1,t.index)),n===a.length-1&&e.push(r.slice(t.index+1)),e}),[]).filter((function(e){return e.length>=2}));if(a.length)return j.query.op.apply(j.query,["or"].concat((0,ve.Z)(a.map((function(t){if(2===t.length&&"math"===t[0].type&&"number"===t[1].type)return j.query.op(t[0].operator,e,j.query.val(t[1].number));var n=t.filter((function(e){return e.operator===Ut})).reduce((function(e,n,r,a){var o=t.indexOf(n);return 0===r?e.push(t.slice(0,o)):e.push(t.slice(t.indexOf(a[r-1])+1,o)),r===a.length-1&&e.push(t.slice(o+1)),e}),[]).filter((function(e){return 2===e.length&&"math"===e[0].type&&"number"===e[1].type}));return n.length?j.query.op.apply(j.query,["and"].concat((0,ve.Z)(n.map((function(t){return j.query.op(t[0].operator,e,j.query.val(t[1].number))}))))):void 0})))));var o=r.filter((function(e){return e.operator===Ut})).reduce((function(e,t,n,a){var o=r.indexOf(t);return 0===n?e.push(r.slice(0,o)):e.push(r.slice(r.indexOf(a[n-1])+1,o)),n===a.length-1&&e.push(r.slice(o+1)),e}),[]).filter((function(e){return 2===e.length&&"math"===e[0].type&&"number"===e[1].type}));if(o.length)return j.query.op.apply(j.query,["and"].concat((0,ve.Z)(o.map((function(t){return j.query.op(t[0].operator,e,j.query.val(t[1].number))})))))}return j.query.op("iLike",j.query.fn("coalesce",j.query.fn("cast",e,j.query.lit("text")),j.query.val("")),j.query.val("%".concat(t,"%")))}(n,r)),e;case"date":case"datetime":return e.push(j.query.op("iLike",j.query.fn("coalesce",j.query.fn("to_char",n,j.query.val("DD/MM/YYYY HH24:MI:SS")),j.query.val("")),j.query.val("%".concat(r,"%")))),e;case"enum":return null!==r?e.push(j.query.op("contains",n,j.query.val(r))):e.push(j.query.op("=",n,j.query.val("{}"))),e}e.push(j.query.op("iLike",j.query.fn("coalesce",j.query.fn("cast",n,j.query.lit("text")),j.query.val("")),j.query.val("%".concat(r,"%"))))}return e}),[]);u.length&&(s.where=1===u.length?u[0]:j.query.op.apply(j.query,["and"].concat((0,ve.Z)(u))))}return s}function Jt(e){var t=e.value;return(0,v.createElement)(ie,{type:"row flex align horizontal"},(0,v.createElement)(y.Input,{type:"checkbox",checked:t,disabled:!0}),(0,v.createElement)(ie,{type:"absolute fill",style:{top:0,left:0}}))}Jt.displayName="booleanLabel";var Yt=new U("objects"),Kt=new U("enum_values"),Gt=new U("searches");function $t(e){var t=e.defaultPageSize,n=void 0===t?15:t,r=e.table,a=e.columns,o=e.searchHistory,c=It(!1),l=(0,g.Z)(c,2),i=l[0],s=l[1],u=It(null),f=(0,g.Z)(u,2),p=f[0],m=f[1],d=It(!1),b=(0,g.Z)(d,2),h=b[0],E=b[1],w=It([]),k=(0,g.Z)(w,2),O=k[0],x=k[1],N=It({}),C=(0,g.Z)(N,2),S=C[0],_=C[1],D=It([]),T=(0,g.Z)(D,2),I=T[0],A=T[1],q=It(!1),B=(0,g.Z)(q,2),F=B[0],M=B[1],V=Bt((function(){return{sorted:xt,filtered:[],pageSize:n,page:0}}),[n]),U=It(V),H=(0,g.Z)(U,2),W=H[0],J=H[1],Y=It(null),K=(0,g.Z)(Y,2),G=K[0],$=K[1],X=qt(te).state.options,Q=Tt((function(){E(!1)}),[]),ee=R(),ne=Ft({filterTimeout:0,objectsCount:0,forceCount:!1,updateSearches:function(e,t){t?m(t.message):ae(e)}}).current,re=L(r),ae=Tt((function(e,t){if(t)m(t.message);else{var n=e.count,r=e.rows;x(r),ne.objectsCount=n,m(null)}}),[]),oe=(r||{}).tableName,ce=Bt((function(){return e=ne.objectsCount,0===(t=W.pageSize)?1:Math.max(1,Math.ceil(e/t));var e,t}),[ne.objectsCount,W.pageSize]);At((function(){W.page>=ce&&J(Dt(Dt({},W),{},{filtered:(0,ve.Z)(W.filtered),page:ce-1}))}),[ce,W]),At((function(){ne.pageJumpState&&ne.pageJumpState(W.page)}),[W.page]);var le=Bt((function(){return r&&r.tableName===(re||{}).tableName?W:V}),[W,oe]),se=Bt((function(){return r&&r.tableName===(re||{}).tableName?O:[]}),[O,oe]),ue=(L(le),Tt((function(e,t){t?m(t.message):(_(Object.keys(e).reduce((function(t,n){return t[n]=e[n].rows,t}),{})),m(null))}),[])),fe=Bt((function(){var e=X||{},t=e.isAdmin,n=e.permissions,r=e.userRoles,a=(n||{})[oe],o={};return a?r.forEach((function(e){var t=a[e];t&&(o=Dt(Dt({},o),t))})):t&&(o={create:!0,read:!0,update:!0,delete:!0}),o}),[X,oe]),pe=z(),me=pe.setTimeout,de=pe.clearTimeout;At((function(){if(r&&le&&!o)return s(!0),Yt.subscribe({context:{tableName:oe},filter:Dt({},Wt(le,r)),searchQuery:!!le.filtered.length},ae,ne.forceCount).catch((function(e){m(e.message)})).finally((function(){s(!1)})),ne.forceCount=!1,function(){Yt.unsubscribe()}}),[r,le]),At((function(){if(r&&!o){var e=r.fields.filter((function(e){return"enum"===e.type})).map((function(e){return e.extend.enumId}));if(e.length)return Kt.subscribe({context:{enumId:e}},ue).catch((function(e){m(e.message)})),function(){Kt.unsubscribe()}}}),[r]),At((function(){if(r&&o)return s(!0),Gt.subscribe({filter:Dt({order:[j.query.orderBy("id",j.query.ASC)]},Wt(le,Zt.metadata)),context:{tableName:oe}},ne.updateSearches,ne.forceCount).catch((function(e){m(e.message)})).finally((function(){s(!1)})),ne.forceCount=!1,function(){Gt.unsubscribe()}}),[r,le]);var be=I[0]||0,ge=se&&be?se.find((function(e){return e.id===be})):void 0,he=Tt((function(){E("OBJECT_CREATE")}),[]),Ee=Tt((function(){E("OBJECT_EDIT")}),[]),we=Tt((function(){E("OBJECT_REMOVE")}),[]),ke=Tt((function(){E("IMPORT_FILE")}),[]),Oe=Tt((function(){E("EXPORT_FILE")}),[]);At((function(){F&&(ge&&Ee(),M(!1))}),[ge,F]);var xe=Tt((function(e){return function(t){var n=t[e.name];switch(e.type){case"enum":var r=n?Array.isArray(n)?n:[n]:[],a=S[e.extend.enumId]||[];return r.map((function(e){return(a.find((function(t){return t.id===e}))||{}).label||e})).join(", ");case"datetime":return(0,v.createElement)(Mt,null,n?(0,v.createElement)(y.Input,{disabled:!0,type:"datetime-local",value:P(n),onChange:function(){}}):"",(0,v.createElement)(ie,{type:"absolute fill",style:{top:0,left:0}}));case"date":return(0,v.createElement)(Mt,null,n?(0,v.createElement)(y.Input,{disabled:!0,type:"date",value:String(n).split("T")[0],onChange:function(){}}):"",(0,v.createElement)(ie,{type:"absolute fill",style:{top:0,left:0}}));case"time":return(0,v.createElement)(Mt,null,(0,v.createElement)(y.Input,{disabled:!0,type:"time",value:Z(n),onChange:function(){}}),(0,v.createElement)(ie,{type:"absolute fill",style:{top:0,left:0}}));case"boolean":return!!n;case"file":var o=n?Array.isArray(n)?n:[n]:[];return(o.length>1?"[".concat(o.length,"] "):"")+o.reduce((function(e,t,n){var r=t.name;return"".concat(e).concat(n>0?", ":"").concat(r)}),"")}return"object"===(0,ye.Z)(n)?JSON.stringify(n):String(n)}}),[S]),Ne=Bt((function(){var e,t=a&&Array.isArray(a);return e=o?Zt.tableColumns:function(e){var t=r?Fe()(r.fields,"extend.order").filter((function(t){return!t.extend.isHidden&&(!e||a.indexOf(t.name)>=0)})).map((function(e){return Dt(Dt({Header:e.extend.caption,id:e.name,accessor:xe(e)},"id"===e.name?{width:60}:{}),{},{Cell:"boolean"===e.type?Jt:void 0,Filter:"enum"!==e.type?void 0:function(){var t=W.filtered.find((function(t){return t.id===e.name})),n=[{value:null,label:"- ".concat(ee("no-value")," -")}].concat((0,ve.Z)((S[e.extend.enumId]||[]).map((function(e){return{value:e.id,label:e.label}})))),r=t&&t.value,a=void 0!==r&&(null===r?[null]:r).map((function(e){return n.find((function(t){return t.value===e}))}));return(0,v.createElement)(y.Select,{options:n,isSearchable:!1,isClearable:!0,isMulti:!1,value:a&&a[0],onChange:function(n){var r=Dt(Dt({},W),{},{filtered:(0,ve.Z)(W.filtered)}),a=r.filtered.indexOf(t);if(a>=0&&r.filtered.splice(a,1),n){var o=Array.isArray(n)?n.map((function(e){return e.value})):[n.value],c=null===o[o.length-1];r.filtered.push({id:e.name,value:c?null:o.filter((function(e){return e}))})}J(r)}})}()})})):[];return t}(t),e}),[r,S,W,a]),Ce=Tt((function(e,t){A(e),M(t)}),[]);if(!r)return(0,v.createElement)(y.Empty,null);var je=!fe.read,Se=!fe.create,Pe=!fe.update,Ze=!fe.delete;return(0,v.createElement)("div",{className:Rt},(0,v.createElement)(y.Notify,{message:p,onClear:function(){return m(null)}}),(0,v.createElement)(y.Popup.Switcher,{active:h,onClose:Q},(0,v.createElement)(nt,{popup:{id:"OBJECT_CREATE",title:ee("create-object")},endpoint:Yt,enumsValues:S,table:r,new:!0,disabled:Se}),(0,v.createElement)(nt,{popup:{id:"OBJECT_EDIT",title:ee("edit-object")},endpoint:Yt,enumsValues:S,object:ge,table:r,disabled:Pe}),(0,v.createElement)(ct,{popup:{id:"OBJECT_REMOVE",title:ee("remove-objects")},endpoint:Yt,selected:I,objects:se,disabled:Ze}),(0,v.createElement)(vt,{popup:{id:"IMPORT_FILE",title:ee("import-file")},table:r}),(0,v.createElement)(kt,{popup:{id:"EXPORT_FILE",title:ee("export-file")},table:r,filter:((Yt.subscription||{}).options||{}).filter||{}})),!o&&(0,v.createElement)("div",{className:"".concat(Rt,"__toolbar")},(0,v.createElement)("div",{className:"".concat(Rt,"__toolbar-buttons")},(0,v.createElement)(y.Button,{onClick:he,disabled:Se,icon:"add",title:ee("add-object")}),(0,v.createElement)(y.Button,{onClick:Ee,disabled:Pe||!ge,icon:"edit",title:ee("edit-object")}),(0,v.createElement)(y.Button,{onClick:we,disabled:Ze||!I.length,icon:"delete",title:ee("remove-objects")}),(0,v.createElement)(y.Button,{onClick:ke,disabled:Se||Pe||Ze,icon:"upload",title:ee("import-file")}),(0,v.createElement)(y.Button,{onClick:Oe,disabled:je,icon:"download",title:ee("export-file")})),(0,v.createElement)("div",{className:"".concat(Rt,"__title")},r.name)),(0,v.createElement)(y.Table,{key:oe,data:se,pages:ce,page:le.page,onPageChange:function(e){ne.forceCount=ne.objectsCount,J(Dt(Dt({},W),{},{page:e}))},sorted:le.sorted,onSortedChange:function(e){ne.forceCount=ne.objectsCount,J(Dt(Dt({},W),{},{sorted:e}))},filtered:G||le.filtered,onFilteredChange:function(e){$(e),ne.filterTimeout&&(de(ne.filterTimeout),ne.filterTimeout=0);var t=/\s*[><=!]+\s*\d+|[^><=!\s]+/;e.every((function(e){var n=e.value;return n&&"string"==typeof n?t.test(n):n}))&&(ne.filterTimeout=me((function(){$(null),ne.filterTimeout=0,J(Dt(Dt({},W),{},{filtered:e,page:0}))}),500))},pageSize:le.pageSize,onPageSizeChange:function(e,t){ne.forceCount=ne.objectsCount,J(Dt(Dt({},W),{},{pageSize:e,page:t}))},columns:Ne,onSelect:Ce,pageSizeOptions:Ot,renderPageJump:function(e){var t=e.onChange,n=e.onBlur,r=e.value,a=e.onKeyPress,o=e.inputType,c=e.pageJumpText;return ne.pageJumpState=function(e){t({target:{value:e+1},preventDefault:function(){}})},(0,v.createElement)("div",{className:"-pageJump"},(0,v.createElement)("input",{"aria-label":c,type:o,onChange:t,value:r,onBlur:n,onKeyPress:a}))}}),i&&(0,v.createElement)(y.Spinner,null))}$t.displayName="DataTable";var Xt={Component:$t,PAGE_SIZE_OPTIONS:Ot,DEFAULT_PAGE_SIZE:15,DEFAULT_SORTED:xt},Qt=E().useState,en=E().useContext,tn=E().useCallback;function nn(e){var t=R(),n=e.onConfirm,r=void 0===n?(0,w.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))):n,a=e.onError,o=void 0===a?(0,w.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))):a,c=e.confirmText,l=void 0===c?t("save"):c,i=e.cancelText,s=void 0===i?t("cancel"):i,u=Qt(!1),f=(0,g.Z)(u,2),p=f[0],m=f[1],d=Qt(null),b=(0,g.Z)(d,2),h=b[0],E=b[1],k=en(y.Popup.Context),O=tn(function(){var e=(0,w.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),m(!0),e.prev=2,e.next=5,r();case 5:k(),e.next=14;break;case 8:return e.prev=8,e.t0=e.catch(2),e.next=12,o(e.t0);case 12:E(e.t0.message),m(!1);case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),[r,o]);return(0,v.createElement)(ie,{type:"col relative",className:"fortressdb-form"},(0,v.createElement)(y.Notify,{message:h,onClear:function(){return E(null)}}),e.children,(0,v.createElement)(ie,{type:"row",className:"fortressdb-form-controls"},(0,v.createElement)(y.Button,{onClick:O},l),(0,v.createElement)(y.Button,{onClick:k},s)),p&&(0,v.createElement)(y.Spinner,null))}nn.displayName="PopupBasicForm";var rn=E().useState,an=E().useCallback;function on(e){var t=R(),n=e.data,r=void 0===n?{}:n,a=e.disabled,o=void 0!==a&&a,c=e.propertyTitle,l=void 0===c?t("name"):c,i=rn(r.name||""),s=(0,g.Z)(i,2),u=s[0],f=s[1],p=an((0,w.Z)(C().mark((function t(){return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.action({name:u}));case 1:case"end":return t.stop()}}),t)}))),[u]);return(0,v.createElement)(nn,{onConfirm:p,confirmText:e.confirmText},(0,v.createElement)(gn,{autoFocus:!0,disabled:o,title:l,type:"string",value:u,changeValue:f}))}on.displayName="NameForm";var cn=E().Fragment,ln="fortressdb-component-page-header";function sn(e){return(0,v.createElement)(cn,null,(0,v.createElement)("div",{alt:"logo",className:"".concat(ln,"__logo")}),e.title&&(0,v.createElement)("div",{className:"".concat(ln,"__logo-title")},e.title))}sn.displayName="Logo";var un="fortressdb-component-page-header";function fn(e){return(0,v.createElement)("div",{className:un},(0,v.createElement)(sn,{title:e.title}),(0,v.createElement)("div",{className:"".concat(un,"__body")},e.children))}fn.displayName="PageHeader";var pn=E().useCallback,mn="fortressdb-component-page-header";function dn(e){var t=e.className,n=e.onClick,r=e.disabled,a=pn((function(){r||n()}),[n,r]);return(0,v.createElement)("div",{className:Ve()("".concat(mn,"__button"),r&&"".concat(mn,"__button_disabled"),t),onClick:a},(0,v.createElement)(y.Icon,{icon:e.icon,color:"white"}),e.children)}function bn(e){return(0,v.createElement)("div",{className:"".concat("fortressdb-component-page-header","__buttons")},e.children)}dn.displayName="PageHeaderButton",bn.displayName="PageHeaderButtons";var vn={Component:fn,Buttons:bn,Button:dn},yn="fortressdb-component-property";function gn(e){var t=e.autoFocus,n=e.title,r=e.disabled,a=void 0!==r&&r,o=e.options,c=void 0===o?[]:o,l=e.type,i=e.isMandatory,s=e.isMultiple,u=e.value,f=e.placeholder,p=e.defaultValue,m=e.changeValue,d=e.reverseOrder,b=void 0!==d&&d,y="checkbox"===e.type||"boolean"===e.type;return(0,v.createElement)("div",{className:Ve()(yn,y&&(b&&"".concat(yn,"_checkbox-reverse")||"".concat(yn,"_checkbox")))},(0,v.createElement)("div",{className:Ve()("".concat(yn,"__title"),i&&"".concat(yn,"__title_mandatory"))},n),(0,v.createElement)(rr,{autoFocus:t,disabled:a,title:n,field:{type:l,value:u,isMandatory:i,isMultiple:s,placeholder:f},options:c,defaultValue:p,changeValue:m}))}gn.displayName="Property";var hn=E().useCallback,En=E().useState,wn=E().useEffect,kn=E().useContext,On=E().useRef,xn=new U("enums");function Nn(e){var t=e.onFetching,n=void 0===t?function(){}:t,r=e.onError,a=void 0===r?function(){}:r,o=e.defaultSelected,c=En(!1),l=(0,g.Z)(c,2),i=l[0],s=l[1],u=En([]),f=(0,g.Z)(u,2),p=f[0],m=f[1],d=kn(te),b=d.state.enums,h=d.dispatch,E=(b||{}).current,w=On({dispatchCurrentEnum:function(e){h({enums:{current:e,watcher:xn}})},updateEnumsValues:function(e,t){if(t)a(t.message);else{var n=e.rows;m(n)}},enums:p}).current,k=hn((function(e){var t=e.value;E&&E.id!==t&&w.dispatchCurrentEnum(p.find((function(e){return e.id===t})))}),[p,E]);wn((function(){if(E)if(p.length){if(w.enums!==p){var e=E.id;w.dispatchCurrentEnum(p.find((function(t){return t.id===e})))}}else w.dispatchCurrentEnum(void 0);w.enums=p}),[p,E]),wn((function(){p.length&&!E&&w.dispatchCurrentEnum(o&&p.find((function(e){return e.id===o}))||p[0])}),[p,E,o]),wn((function(){return s(!0),n(!0),w.dispatchCurrentEnum(null),xn.subscribe({filter:{}},w.updateEnumsValues).catch((function(e){a(e.message)})).finally((function(){s(!1),n(!1)})),function(){xn.unsubscribe(),h({enums:void 0})}}),[]);var O=R(),x=i?[]:p.length?p.map((function(e){return{value:e.id,label:e.name}})):[{value:-1,label:O("no-items")}],N=p.length?(E||{}).id:-1,C=x.find((function(e){return e.value===N}));return(0,v.createElement)("div",{className:"fortressdb-component-select-picklist"},(0,v.createElement)(y.Select,{options:x,value:C,isDisabled:i||0===p.length,onChange:k}),i&&(0,v.createElement)(y.Spinner,{small:!0}))}function Cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Cn(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Nn.displayName="SelectPicklist";var Sn=E().useCallback,Pn=E().useState,Zn=E().useEffect,_n=E().useContext,Dn=E().useRef,Tn=new U("metadata");function In(e){var t=e.onFetching,n=void 0===t?function(){}:t,r=e.onError,a=void 0===r?function(){}:r,o=e.defaultSelected,c=e.selectForms,l=void 0===c?"all":c,i=Pn(!1),s=(0,g.Z)(i,2),u=s[0],f=s[1],p=Pn([]),m=(0,g.Z)(p,2),d=m[0],b=m[1],h=_n(te),E=h.state.tables,w=h.dispatch,k=(E||{}).current,O=Dn({dispatchCurrentTable:function(e){w({tables:{current:e,watcher:Tn}})},updateMetadata:function(e,t){if(t)a(t.message);else{var n=e.rows;b(n)}},metadata:d}).current,x=Sn((function(e){var t=e.value;k&&k.id!==t&&O.dispatchCurrentTable(d.find((function(e){return e.id===t})))}),[d,k]);Zn((function(){if(k)if(d.length){if(O.metadata!==d){var e=k.id;O.dispatchCurrentTable(d.find((function(t){return t.id===e})))}}else O.dispatchCurrentTable(void 0);O.metadata=d}),[d,k]),Zn((function(){d.length&&!k&&O.dispatchCurrentTable(o&&d.find((function(e){return e.tableName===o}))||d[0])}),[d,k,o]),Zn((function(){return f(!0),n(!0),O.dispatchCurrentTable(null),Tn.subscribe({filter:jn({order:[j.query.orderBy("name")]},"all"===l?{}:{where:j.query.op("secure"===l?"?":"!?",j.query.fn("cast","options",j.query.lit("jsonb")),j.query.val("source"))})},O.updateMetadata).catch((function(e){a(e.message)})).finally((function(){f(!1),n(!1)})),function(){Tn.unsubscribe(),w({tables:void 0})}}),[]);var N=R(),C=u?[]:d.length?d.map((function(e){return{value:e.id,label:e.name}})):[{value:-1,label:N("no-items")}],S=d.length?(k||{}).id:-1,P=C.find((function(e){return e.value===S}));return(0,v.createElement)("div",{className:"fortressdb-component-select-table"},(0,v.createElement)(y.Select,{options:C,value:P,isDisabled:u||0===d.length,onChange:x}),u&&(0,v.createElement)(y.Spinner,{small:!0}))}In.displayName="SelectTable";var An=n(7503);function qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qn(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fn=(0,An.W8)((function(e){var t=e.index,n=e.element,r=e.data,a=e.accessorId;return E().cloneElement(n,Bn(Bn({},r),{},{key:"item-".concat(r[a]),index:t}))})),Mn=(0,An.JN)((function(e){var t=e.items,n=e.footer,r=void 0===n?null:n,a=e.header,o=void 0===a?null:a,c=e.element,l=e.accessorId,i=void 0===l?"id":l,s=e.disabled,u=void 0!==s&&s;return(0,v.createElement)("ul",{className:"fortressdb-sortable-list-wrapper"},o,t.map((function(e,t){return(0,v.createElement)(Fn,{key:"item-".concat(e[i]),index:t,data:e,element:c,accessorId:i,disabled:u})})),r)}));Mn.displayName="SortableList";var Rn=n(8029),Ln=n.n(Rn),Vn=E().useState,zn=E().useMemo,Un=E().useEffect,Hn=E().useCallback,Wn=E().Fragment,Jn="fortressdb-component-tariff-plan";function Yn(e){var t=e.plan,n=e.planNumber,r=e.readOnly,a=void 0!==r&&r,o=e.disabled,c=void 0!==o&&o,l=e.discount,i=void 0===l?null:l,s=e.licensePlanId,u=e.licenseStatus,f=e.onPay,p=e.onUnsubscribe,m=e.upgrade,d=void 0!==m&&m,b=Vn(!1),h=(0,g.Z)(b,2),E=h[0],k=h[1],O=zn((function(){return(0,ve.Z)(t.period||[]).sort((function(e,t){var n=e.name,r=t.name;return n===r?0:n>r?1:-1}))}),[t.period]),x=L(O),N=Vn(s&&O.find((function(e){return e.id===s}))||O[0]),j=(0,g.Z)(N,2),P=j[0],Z=j[1];Un((function(){x&&x!==O&&P&&Z(O.find((function(e){return e.name===P.name}))||O[0])}),[O,x,P]);var _=zn((function(){return S(P.price,i)}),[P,i]),D=zn((function(){return O.map((function(e){return{value:e,label:Ln()(e.name)}}))}),[O]),T=R(),I=Hn((0,w.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f){e.next=5;break}return k(!0),e.next=4,f(P.id);case 4:k(!1);case 5:case"end":return e.stop()}}),e)})))),A=Hn((0,w.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p){e.next=5;break}return k(!0),e.next=4,p(P.id);case 4:k(!1);case 5:case"end":return e.stop()}}),e)}))));return(0,v.createElement)(ie,{type:"col",className:Ve()(Jn,"fortressdb-plan","fortressdb-plan-".concat(t.name))},!!n&&(0,v.createElement)("div",{className:Ve()("".concat(Jn,"__number"),!1)},n),!!t.tag&&(0,v.createElement)(ie,{type:"row align horizontal"},(0,v.createElement)(ie,{type:"col",className:Ve()("fortressdb-plan-flag","fortressdb-plan-flag-".concat(t.tag))},t.tag)),(0,v.createElement)(ie,{type:"row align horizontal",className:"fortressdb-plan-image-wrapper"},(0,v.createElement)(ie,{type:"col",className:Ve()("fortressdb-plan-image","fortressdb-plan-image-".concat(t.name))})),(0,v.createElement)(ie,{type:"row align horizontal"},(0,v.createElement)(ie,{type:"col"},(0,v.createElement)("h1",{className:"fortressdb-plan-title"},t.name))),(0,v.createElement)(ie,{type:"row "},(0,v.createElement)(ie,{type:"col flex",className:"fortressdb-plan-restrictions"},(0,v.createElement)(y.OptionsList,{items:t.restrictions.map((function(e){var t=e.name,n=e.caption,r=e.value,a=e.units;return{name:t,value:n?Ln()(n):a?"".concat(r," ").concat(a):r}}))}))),O.length>1&&(0,v.createElement)(Wn,null,(0,v.createElement)(ie,{type:"row align horizontal flex",className:"fortressdb-plan-period"},(0,v.createElement)(y.Select,{className:"fortressdb-plan-period-select",options:D,value:D.find((function(e){return e.value===P})),onChange:function(e){var t=e.value;Z(t)}})),(0,v.createElement)(ie,{type:"row align horizontal",className:"fortressdb-plan-cost"},_!==P.price?(0,v.createElement)("span",null,(0,v.createElement)(y.Price,{currency:P.units,value:P.price,className:"fortressdb-plan-old-price"}),_?(0,v.createElement)(y.Price,{currency:P.units,value:_,className:"fortressdb-plan-new-price"}):(0,v.createElement)("span",{className:"fortressdb-plan-new-price"},T("for-free"))):(0,v.createElement)(y.Price,{currency:P.units,value:P.price})),!a&&(0,v.createElement)(ie,{type:"row align horizontal flex",className:"fortressdb-plan-upgrade"},P.id===s&&"cancelled"!==u?(0,v.createElement)(y.Button,{className:"fortressdb-plan-unsubscribe",disabled:c,onClick:A},T("unsubscribe")):(0,v.createElement)(y.Button,{disabled:c,onClick:I},T(d?"upgrade":"buy")))),E&&(0,v.createElement)(y.Spinner,null))}function Kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kn(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Yn.displayName="TariffPlan";var $n=E().useState,Xn=E().useEffect,Qn=E().useCallback,er=E().useRef,tr="fortressdb-component-type-control",nr=[{size:1e3,label:"KB"},{size:1e6,label:"MB"},{size:1e9,label:"GB"}],rr=(0,y.ErrorBoundary)((function(e){var t=e.disabled,n=e.className,r=e.autoFocus,a=e.changeValue,o=void 0===a?function(){}:a,c=e.field,l=void 0===c?{}:c,i=e.options,s=void 0===i?[]:i,u=e.acceptFiles,f=void 0===u?"*":u,p=l.type,m=l.placeholder,d=void 0===m?"":m,b="enum"===p&&l.isMultiple,h=void 0!==e.defaultValue?e.defaultValue:_(p),E=void 0!==l.value?l.value:h,k=$n([]),O=(0,g.Z)(k,2),x=O[0],N=O[1],j=$n(!1),S=(0,g.Z)(j,2),T=S[0],A=S[1],q=V(),B=R();function F(){return F=(0,w.Z)(C().mark((function e(t){var n;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(!0),e.prev=1,e.next=4,Promise.all(t.map((function(e){return e&&"string"==typeof e.type&&e.type.startsWith("image")?q((0,I.q)(e,"thumb").catch((function(){return null}))):null})));case 4:n=e.sent,N(n),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:A(!1);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),F.apply(this,arguments)}Xn((function(){return function(){x&&URL.revokeObjectURL(x)}}),[x]),Xn((function(){"file"===p&&function(e){F.apply(this,arguments)}(E?Array.isArray(E)?E:[E]:[])}),[p,E]);var M=Qn(function(){var e=(0,w.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(!0),e.next=3,q((0,D.S)(t));case 3:A(!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),L=Qn((function(){if(!s.length)return b?[]:null;if(!b){if(!E)return null;var e=Array.isArray(E)?E[0]:E;return s.find((function(t){return t.value===e}))||s[0]}var t=Array.isArray(E)?E:[E];return s.filter((function(e){return t.includes(e.value)}))}),[E,s,b]),z=er(null);switch(p){case"text":return(0,v.createElement)(y.Textarea,{autoFocus:r,placeholder:d,className:n,disabled:t,value:null===E?"":E,onChange:function(e){return o(e.target.value)}});case"string":case"uuid":return(0,v.createElement)(y.Input,{autoFocus:r,placeholder:d,className:n,disabled:t,value:null===E?"":E,onChange:function(e){return o(e.target.value)}});case"json":return(0,v.createElement)(y.Textarea,{autoFocus:r,placeholder:d,className:n,disabled:t,value:null===E?"":"object"===(0,ye.Z)(E)?JSON.stringify(E):E,onChange:function(e){return o(e.target.value)}});case"integer":case"float":return(0,v.createElement)(y.Input,{type:"number",autoFocus:r,placeholder:d,className:n,disabled:t,value:E,onChange:function(e){return o(e.target.valueAsNumber)}});case"checkbox":case"boolean":return(0,v.createElement)(y.Input,{type:"checkbox",autoFocus:r,className:n,disabled:t,checked:E,onChange:function(e){return o(e.target.checked)}});case"date":return(0,v.createElement)(y.Input,{type:"date",autoFocus:r,placeholder:d,className:n,disabled:t,value:E?String(E).split("T")[0]:"",onChange:function(e){var t=e.target.value;o(t&&new Date(t).toISOString())}});case"datetime":return(0,v.createElement)(y.Input,{type:"datetime-local",autoFocus:r,placeholder:d,className:n,disabled:t,value:P(E),onChange:function(e){var t=e.target.value;o(t&&new Date(t).toISOString())}});case"time":return(0,v.createElement)(y.Input,{type:"time",autoFocus:r,placeholder:d,className:n,disabled:t,value:Z(E),onChange:function(e){var t=e.target.value;if(!t)return o(0);var n=t.split(":"),r=(0,g.Z)(n,2),a=r[0],c=void 0===a?0:a,l=r[1],i=void 0===l?0:l;return o(60*parseInt(c)*60+60*parseInt(i))}});case"select":case"enum":return(0,v.createElement)(y.Select,{autoFocus:r,placeholder:d,className:n,isSearchable:!1,isDisabled:t,isMulti:b,isOptionDisabled:function(e){return e.disabled},onChange:function(e){return o(e?"enum"===p?b?e.map((function(e){return e.value})).filter((function(e){return e})):e.value?[e.value]:[]:e.value:b?[]:null)},options:s,value:L(E)});case"file":var U=E?Array.isArray(E)?E:[E]:[];return(0,v.createElement)("div",{className:"".concat(tr,"_file")},T&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(y.Input,{type:"file",inputRef:z,accept:f,onChange:function(e){o([].concat((0,ve.Z)(U),(0,ve.Z)(e.target.files)))},value:[],multiple:!0,className:"".concat(tr,"__file-hidden-input")}),(0,v.createElement)("div",{className:"".concat(tr,"__file-list")},U.map((function(e,n){var r="string"==typeof e.type&&e.type.startsWith("image"),a=r&&x[n];return(0,v.createElement)("div",{key:n,className:"".concat(tr,"__file-descriptor")},!!r&&(0,v.createElement)("div",{key:n,className:"".concat(tr,"__file-preview"),style:Gn({},a?{backgroundImage:"url(".concat(a,")")}:{})}),(0,v.createElement)("div",{className:"".concat(tr,"__file-info")},(0,v.createElement)("div",{className:"".concat(tr,"__file-name"),title:e.name},e.name),(0,v.createElement)("div",{className:"".concat(tr,"__file-size")},function(e){for(var t=nr.length-1;t>=0&&e<nr[t].size;)--t;if(t<0)return"".concat(e,"B");var n=nr[t],r=n.size,a=n.label;return"".concat((10*e/r+.5>>0)/10).concat(a)}(e.size))),(0,v.createElement)("div",{className:"".concat(tr,"__file-controls")},(0,v.createElement)(y.Button,{icon:"delete",title:B("delete"),disabled:t,onClick:function(){var e=(0,ve.Z)(U);e.splice(n,1),o(e)}}),!(e instanceof File)&&(0,v.createElement)(y.Button,{icon:"download",title:B("download"),onClick:function(){M(e)}})))}))),!t&&(0,v.createElement)("div",null,(0,v.createElement)(y.Button,{icon:"add",color:"black",title:B("add-file"),onClick:function(e){return z.current.click()}})))}return null})),ar={current_page:{backgroundColor:null,color:null},page:{backgroundColor:null,color:null},button:{backgroundColor:null,color:null}},or=(0,h.createContext)(ar),cr=E().Fragment,lr=E().useContext;function ir(e){var t=e.label,n=e.disabled,r=e.onClick,a=e.direction,o=lr(or),c=n?(0,v.createElement)("span",{className:Ve()(["label","disabled",a])},t):(0,v.createElement)("a",{href:"",className:Ve()(["label","enabled",a]),onClick:function(e){e.preventDefault(),e.stopPropagation(),r()}},t);return(0,v.createElement)("div",{style:o.button,className:"pagination-button"},c)}function sr(e){var t=e.label,n=e.isCurrent,r=e.onClick,a=lr(or);return(0,v.createElement)("a",{href:"",key:0,className:n?"current":"other",onClick:r,style:n?a.current_page:a.page},t)}function ur(e){var t=e.page,n=void 0===t?0:t,r=e.perPage,a=void 0===r?1:r,o=e.totalObjects,c=void 0===o?0:o,l=e.onPageChange,i=void 0===l?function(){}:l,s=e.pagesToShow,u=void 0===s?5:s,f=Math.ceil(c/a),p=!1,m=!1;if(f<=1)return(0,v.createElement)("div",null);var d=function(e){return function(t){t.preventDefault(),e<0||e>f||i(e)}},b=function(){return!(n>=f-1)},y=function(){return!(n<=0)},g=[],h=Math.floor(Math.min(f,u)/2),E=Math.max(0,n-h),w=Math.min(E+u,f);0!==(E=Math.max(w-u,0))&&(p=!0,E++),w!==f&&(m=!0,w--);for(var k=E;k<w;k++)g.push(k);return(0,v.createElement)("div",{className:Ve()(["pagination-container",e.className])},(0,v.createElement)("div",{className:"fdb-pagination"},(0,v.createElement)(ir,{onClick:function(){y()&&i(n-1)},disabled:!y(),label:String.fromCharCode(171),direction:"dec"}),(0,v.createElement)("div",{className:"pagination-pages"},p&&(0,v.createElement)(cr,null,(0,v.createElement)(sr,{label:1,onClick:d(0),isCurrent:0===n}),(0,v.createElement)("span",{className:"hellip"},"")),g.map((function(e){return(0,v.createElement)(sr,{label:e+1,isCurrent:e===n,onClick:d(e),key:e})})),m&&(0,v.createElement)(cr,null,(0,v.createElement)("span",{className:"hellip"},""),(0,v.createElement)(sr,{label:f,onClick:d(f-1),isCurrent:n===f-1}))),(0,v.createElement)(ir,{onClick:function(){b()&&i(n+1)},disabled:!b(),label:String.fromCharCode(187),direction:"inc"})))}ir.displayName="StepButton",sr.displayName="PageButton",ur.displayName="Pagination";const fr=window.wp.blockEditor;var pr=n(6913),mr=n.n(pr),dr=E().useState,br=E().useEffect;function vr(e){var t=e.onChange,n=void 0===t?function(){}:t,r=mr()(e.theme||{},ar),a=dr(r.button.color||""),o=(0,g.Z)(a,2),c=o[0],l=o[1],i=dr(r.button.backgroundColor||""),s=(0,g.Z)(i,2),u=s[0],f=s[1],p=dr(r.current_page.color||""),m=(0,g.Z)(p,2),d=m[0],b=m[1],y=dr(r.current_page.backgroundColor||""),h=(0,g.Z)(y,2),E=h[0],w=h[1],k=dr(r.page.color||""),O=(0,g.Z)(k,2),x=O[0],N=O[1],C=dr(r.page.backgroundColor||""),j=(0,g.Z)(C,2),S=j[0],P=j[1];return br((function(){var e={current_page:{backgroundColor:E,color:d},page:{backgroundColor:S,color:x},button:{backgroundColor:u,color:c}};e=mr()(e,ar),n(e)}),[c,u,d,E,x,S,n]),(0,v.createElement)(fr.PanelColorSettings,{initialOpen:!1,title:"Pagination color scheme",colorSettings:[{value:c,onChange:l,label:"Buttons text color"},{value:u,onChange:f,label:"Buttons background color"},{value:d,onChange:b,label:"Current page text color"},{value:E,onChange:w,label:"Current page background color"},{value:x,onChange:N,label:"Other pages text color"},{value:S,onChange:P,label:"Other pages background color"}]})}vr.displayName="ThemeControl";var yr={container:{backgroundColor:null},label:{color:null},button:{backgroundColor:null,color:null},input:{backgroundColor:null,color:null,borderColor:null}},gr=E().useState,hr=E().useEffect;function Er(e){var t=e.onChange,n=void 0===t?function(){}:t,r=mr()(e.theme||{},yr),a=gr(r.container.backgroundColor||""),o=(0,g.Z)(a,2),c=o[0],l=o[1],i=gr(r.button.backgroundColor||""),s=(0,g.Z)(i,2),u=s[0],f=s[1],p=gr(r.button.color||""),m=(0,g.Z)(p,2),d=m[0],b=m[1],y=gr(r.input.backgroundColor||""),h=(0,g.Z)(y,2),E=h[0],w=h[1],k=gr(r.input.borderColor||""),O=(0,g.Z)(k,2),x=O[0],N=O[1],C=gr(r.label.color||""),j=(0,g.Z)(C,2),S=j[0],P=j[1],Z=gr(r.input.color||""),_=(0,g.Z)(Z,2),D=_[0],T=_[1];return hr((function(){var e={container:{backgroundColor:c},label:{color:S},button:{backgroundColor:u,color:d},input:{backgroundColor:E,color:D,borderColor:x}};e=mr()(e,yr),n(e)}),[c,u,d,E,x,S,D,n]),(0,v.createElement)(fr.PanelColorSettings,{initialOpen:!1,title:"Search box color scheme",colorSettings:[{value:c,onChange:l,label:"Background"},{value:u,onChange:f,label:"Button background"},{value:d,onChange:b,label:"Button text"},{value:E,onChange:w,label:"Input background"},{value:x,onChange:N,label:"Input outline"},{value:D,onChange:T,label:"Input text"},{value:S,onChange:P,label:"Label"}]})}Er.displayName="ThemeControl";var wr=(0,h.createContext)(yr),kr=n(8400),Or=n.n(kr),xr=["type"];function Nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Cr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nr(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var jr=E().useState,Sr=E().useMemo,Pr=E().useContext;function Zr(e){var t=e.name,n=e.onChange,r=Pr(wr),a=Cr(Cr({},r.input),{},{borderWidth:r.input.borderColor===yr.input.backgroundColor?"none":"thin"});return(0,v.createElement)(y.Input,{style:a,id:t,onChange:function(e){var t=e.target.value;n(t.replace(/[\0\n\r\b\t\\'"\x1a]/g,(function(e){switch(e){case"\0":return"\\0";case"\n":return"\\n";case"\r":return"\\r";case"\b":return"\\b";case"\t":return"\\t";case"":return"\\Z";case"'":return"''";case'"':return'""';default:return"\\"+e}})))}})}function _r(e){var t=e.name,n=e.field,r=e.onChange,a=e.enumValue.map((function(e){return{value:e.id,label:e.label}})),o=Pr(wr),c=(n.extend||{}).isMultiple||!1,l=Object.keys(o.input).reduce((function(e,t){return o.input[t]&&(e[t]=o.input[t]),e}),{}),i={control:function(e){return mr()({},l,e)},singleValue:function(e){return mr()({},l,e)},multiValue:function(e){return mr()({},l,e)},multiValueLabel:function(e){return mr()({},l,e)}};return(0,v.createElement)(y.Select,{name:t,options:a,isMulti:c,isClearable:!0,onChange:function(e){var t;t=(t=Array.isArray(e)?(0,ve.Z)(e):[e]).filter((function(e){return!!e})),r(t.map((function(e){return e.value})))},styles:i})}function Dr(e){var t=e.name,n=e.theme,r=e.label;return(0,v.createElement)("div",{className:"searchField"},(0,v.createElement)("label",{htmlFor:t,style:n.label},r,":"),e.children)}function Tr(e){var t=e.name,n=e.theme,r=e.label,a=e.isSingleRow,o=void 0!==a&&a?{colSpan:3}:{};return(0,v.createElement)(v.Fragment,null,(0,v.createElement)("td",{className:"field-name"},(0,v.createElement)("label",{htmlFor:t,style:n.label},r,":")),(0,v.createElement)("td",o,e.children))}function Ir(e){var t=e.field,n=e.onChange,r=e.enumValues,a=e.type,o=void 0===a?"vertical":a,c=e.isSingleRow,l=void 0!==c&&c,i=Pr(wr),s=t.name,u=e.label?e.label:(t.extend||{}).caption||s,f=null;if("text"===t.type||"string"===t.type?f=Zr:"enum"===t.type&&(f=_r),null===f)return(0,v.createElement)("div",null);var p=null;if("enum"===t.type){var m=(t.extend||{}).enumId||null;m&&(p=r[m]||[])}var d="horizontal"===o?Tr:Dr;return(0,v.createElement)(d,{name:s,label:u,theme:i,isSingleRow:l},(0,v.createElement)(f,{onChange:n,name:s,field:t,enumValue:p}))}function Ar(e){var t=e.theme,n=e.handleFieldChange,r=void 0===n?function(e){return function(e){}}:n,a=e.enumValues,o=void 0===a?{}:a,c=e.onSearchClick,l=void 0===c?function(){}:c,i=e.fields,s=void 0===i?[]:i,u=e.labels,f=void 0===u?{}:u;return(0,v.createElement)("div",{className:"fdb-searchbox",style:t.container},(0,v.createElement)("div",{className:"fdb-searchbox-fieldset"},s.map((function(e){return(0,v.createElement)(Ir,{type:"vertical",field:e,onChange:r(e.name),enumValues:o,label:f[e.name]||null})}))),(0,v.createElement)(y.Button,{onClick:function(){return l()},className:"searchButton",style:t.button},"Search"))}function qr(e){var t=e.theme,n=e.handleFieldChange,r=void 0===n?function(e){return function(e){}}:n,a=e.enumValues,o=void 0===a?{}:a,c=e.onSearchClick,l=void 0===c?function(){}:c,i=e.fields,s=void 0===i?[]:i,u=e.labels,f=void 0===u?{}:u;return(0,v.createElement)("div",{className:"fdb-searchbox-horizontal",style:t.container},(0,v.createElement)("div",{className:"fdb-searchbox-fieldset"},(0,v.createElement)("table",{className:"fdb-searchbox-table"},Or()(s,2).map((function(e){return 2===e.length?(0,v.createElement)("tr",null,(0,v.createElement)(Ir,{type:"horizontal",field:e[0],onChange:r(e[0].name),enumValues:o,label:f[e[0].name]||null}),(0,v.createElement)(Ir,{type:"horizontal",field:e[1],onChange:r(e[1].name),enumValues:o,label:f[e[1].name]||null})):(0,v.createElement)("tr",null,(0,v.createElement)(Ir,{isSingleRow:!0,type:"horizontal",field:e[0],onChange:r(e[0].name),enumValues:o,label:f[e[0].name]||null}))})))),(0,v.createElement)(y.Button,{onClick:function(){return l()},className:"searchButton",style:t.button},"Search"))}function Br(e){var t=e.type,n=void 0===t?"vertical":t,r=(0,ae.Z)(e,xr),a=Pr(wr),o=jr({}),c=(0,g.Z)(o,2),l=c[0],i=c[1],s=r.table,f=r.searchableFields,p=r.enumValues,m=r.onChange,d=void 0===m?function(e){}:m,b=r.labels,y=void 0===b?{}:b,h=Sr((function(){return s?s.fields.filter((function(e){return f.includes(e.name)})):[]}),[s,f]);if(h.length<=0)return(0,v.createElement)("div",null);var E="horizontal"===n?qr:Ar;return(0,v.createElement)(E,{theme:a,labels:y,handleFieldChange:function(e){return function(t){i(Cr(Cr({},l),{},(0,u.Z)({},e,t)))}},enumValues:p,onSearchClick:function(){return d(l)},fields:h})}Zr.displayName="SearchStringInput",_r.displayName="SearchEnumInput",Dr.displayName="SearchFieldVertical",Ir.displayName="SearchField",Ar.displayName="SearchBoxVertical",qr.displayName="SearchBoxHorizontal",Br.displayName="SearchBox";const Fr=window.wp.components;function Mr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mr(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lr(e){var t=e.tableFields,n=void 0===t?[]:t,r=e.labels,a=void 0===r?{}:r,o=e.onChange,c=e.labelStyle,l=void 0===c?"vertical":c,i=e.onLabelStyleChange,s=function(e){var t,r=n.find((function(t){return t.name===e}));return(null==r||null===(t=r.extend)||void 0===t?void 0:t.caption)||"Error"},f=function(e){return function(t){o(Rr(Rr({},a),{},(0,u.Z)({},e,t)))}};return(0,v.createElement)(Fr.Panel,null,(0,v.createElement)(Fr.PanelBody,{title:"Search field labels",initialOpen:!1},n.map((function(e,t){return(0,v.createElement)(Fr.PanelRow,{key:t},(0,v.createElement)(Fr.TextControl,{value:(n=e.name,r=a[n],r||s(n)),label:s(e.name),onChange:f(e.name)}));var n,r})),(0,v.createElement)(Fr.PanelRow,null,(0,v.createElement)(Fr.ToggleControl,{label:"Labels on the left",help:"horizontal"===l?"Toggle to put labels on top of the field":"Toggle to put labels on the left of the field",checked:"horizontal"===l,onChange:function(e){i(e?"horizontal":"vertical")}}))))}Lr.displayName="LabelsControl";var Vr=n(1850),zr=n.n(Vr);function Ur(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ur(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ur(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wr,Jr=E().Fragment,Yr=function(e){Wr||(Wr=new Promise((function(e){var t=0,n=function(n){(0,m.Z)(c,n);var r,a,o=(r=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,b.Z)(r);if(a){var n=(0,b.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,d.Z)(this,e)});function c(e){var t;return(0,f.Z)(this,c),(t=o.call(this,e)).state={children:{}},t}return(0,p.Z)(c,[{key:"componentDidMount",value:function(){e(this)}},{key:"addChild",value:function(e){var n=this;return new Promise((function(r){n.setState((function(n){var a=n.children,o=++t;return setTimeout((function(){r(o)}),0),{children:Hr(Hr({},a),{},(0,u.Z)({},o,(0,v.createElement)(Jr,{key:o},e)))}}))}))}},{key:"removeChild",value:function(e){this.setState((function(t){var n=t.children;if(n[e]){var r=Hr({},n);return delete r[e],{children:r}}}))}},{key:"render",value:function(){var e=this.state.children;return(0,v.createElement)(ee,{license:!0},Object.keys(e).map((function(t){return e[t]})))}}]),c}(E().Component);n.displayName="Root";var r=document.createElement("div");r.id="fortressdb-blocks-root",document.body.appendChild(r),zr().render((0,v.createElement)(n,null),r)}))),Wr=Wr.then((function(t){return e(t),t}))},Kr=new Promise((function(e){document.addEventListener("DOMContentLoaded",e)}));function Gr(e,t){Kr=Kr.then((function(){for(var n=document.getElementsByClassName(e),r=function(e,r){var a=n[e],o=JSON.parse((a.dataset||{}).attributes||null);Yr((function(e){e.addChild(zr().createPortal((0,v.createElement)(t,{attributes:o}),a))}))},a=0,o=n.length;a<o;++a)r(a)}))}function $r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$r(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qr=E().useState,ea=E().useContext,ta=E().useCallback,na=E().useEffect,ra=E().useMemo,aa=E().Fragment,oa="fortressdb-edit-block";function ca(e){var t=e.attributes,n=e.setAttributes,r=Qr(!1),a=(0,g.Z)(r,2),o=a[0],c=a[1],l=Qr(""),i=(0,g.Z)(l,2),s=i[0],u=i[1],f=ea(te).state,p=f.options,m=f.tables,d=(void 0===m?{}:m).current,b=ta((function(e){var t=e.value;n({defaultPageSize:t})}),[]),h=t.defaultPageSize,E=t.tableName,w=t.settings;na((function(){d&&d.tableName!==E&&n({tableName:d.tableName,settings:Xr(Xr({},w),{},{columns:d.fields.map((function(e){return e.name}))})})}),[d,E,w]);var k=ra((function(){return Xt.PAGE_SIZE_OPTIONS.map((function(e){return{value:e,label:"".concat(e," rows")}}))}),[]),O=ta((function(e,t){var r=(w.columns||[]).filter((function(t){return t!==e}));t&&r.push(e),n({settings:Xr(Xr({},w),{},{columns:r})})}),[w]),x=ra((function(){if(!d)return[];var e=w.columns||[];return d.fields.filter((function(e){return!e.extend.isHidden})).map((function(t){return{value:t.name,label:(0,v.createElement)(ie,{type:"row",onClick:function(e){return e.stopPropagation()}},(0,v.createElement)(y.Input,{type:"checkbox",checked:e.indexOf(t.name)>=0,onChange:function(e){var n=e.target.checked;O(t.name,n)}}),(0,v.createElement)("div",null,t.extend.caption))}}))}),[d,O,w.columns]),N=R(),C=!(!p||!p.connected);return na((function(){C||u(N("plugin-not-connected"))}),[C]),(0,v.createElement)("div",{className:Ve()(e.className,oa,"".concat(oa,"_table"),e.isSelected&&"".concat(oa,"_selected"))},o&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(y.Notify,{message:s,onClear:function(){return u(null)}}),(0,v.createElement)(ie,{type:"row align vertical space between",className:"fortressdb-block-title"},(0,v.createElement)(ie,null,"Table"),(0,v.createElement)(ie,{type:"background contain",className:"fortressdb-logo fortressdb-block-logo"})),C&&(0,v.createElement)(aa,null,(0,v.createElement)(ie,{className:"fortressdb-block-section"},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Data Source"),(0,v.createElement)(ie,{type:"row wrap relative"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-section-options"},(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Table:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(In,{defaultSelected:E,onFetching:c,onError:u}))),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Page size:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Select,{options:k,value:k.find((function(e){return e.value===h})),onChange:b}))),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Columns:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Select,{options:x,value:null,onChange:function(){}})))))),(0,v.createElement)(ie,{className:"fortressdb-block-section"},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Preview"),(0,v.createElement)(ie,{type:"col relative"},d&&(0,v.createElement)(Xt.Component,{key:h,defaultPageSize:h,table:d,columns:w.columns})))))}function la(e){return(0,v.createElement)("div",{className:"fortressdb-block fortressdb-block_edit fortressdb-block_table"},(0,v.createElement)(ee,null,(0,v.createElement)(ne,null,(0,v.createElement)(ca,e))))}ca.displayName="EditForm",la.displayName="Edit";var ia="fortressdb-block-table";function sa(e){var t=e.attributes;return(0,v.createElement)("div",{className:ia,"data-attributes":JSON.stringify(t)})}sa.displayName="Save";var ua=E().useContext,fa=E().useEffect,pa=E().useState,ma="fortressdb-view-block",da=new U("metadata");function ba(e){var t=e.attributes,n=t.defaultPageSize,r=t.tableName,a=t.settings,o=ua(te).state.options,c=pa(!1),l=(0,g.Z)(c,2),i=l[0],s=l[1],u=pa(null),f=(0,g.Z)(u,2),p=f[0],m=f[1],d=pa(null),b=(0,g.Z)(d,2),h=b[0],E=b[1],w=(o||{}).connected;fa((function(){if(r&&w)return s(!0),da.subscribe({filter:{where:j.query.op("=","tableName",j.query.val(r))}},(function(e,t){if(t)m(t.message);else{var n=e.rows.find((function(e){return e.tableName===r}));if(!n)throw new Error("Selected table is not found");E(n),m(null)}})).catch((function(e){m(e.message)})).finally((function(){s(!1)})),function(){da.unsubscribe()}}),[r,w]);var k=R();return(0,v.createElement)("div",{className:"fortressdb-block fortressdb-block_view fortressdb-block_table"},(0,v.createElement)(ne,null,(0,v.createElement)("div",{className:Ve()(e.className,ma,"".concat(ma,"_table"))},i&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(y.Notify,{message:p,onClear:function(){return m(null)}}),w?h&&(0,v.createElement)(Xt.Component,{defaultPageSize:n,table:h,columns:a.columns}):(0,v.createElement)(y.Notify,{message:k("plugin-not-connected")}))))}function va(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ya(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?va(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):va(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}ba.displayName="View";var ga=E().useState,ha=E().useContext,Ea=E().useCallback,wa=E().useEffect,ka=E().useMemo,Oa=E().Fragment,xa="fortressdb-edit-block",Na=500,Ca={Line:{xType:["string","number","datetime"],yType:["number"],multiAxis:!0,titles:{chart:!0,vAxis:!0,hAxis:!0}},Area:{xType:["string","number","datetime"],yType:["number"],multiAxis:!0,titles:{chart:!0,vAxis:!0,hAxis:!0}},Column:{xType:["string","number","datetime"],yType:["number"],multiAxis:!0,titles:{chart:!0,vAxis:!0,hAxis:!0}},Pie:{xType:["string"],yType:["number"],multiAxis:!1,titles:{chart:!0}}},ja=[{name:"Line",className:"LineChart",version:"current",packages:["corechart"],options:{width:"100%",height:Na}},{name:"Area",className:"AreaChart",version:"current",packages:["corechart"],options:{width:"100%",height:Na}},{name:"Column",className:"ColumnChart",version:"current",packages:["corechart"],options:{width:"100%",height:Na}},{name:"Pie",className:"PieChart",version:"current",packages:["corechart"],options:{width:"100%",height:Na}}],Sa=["string","enum"],Pa=["date"],Za=["integer","float"],_a={x:"",y:[],order:"",group:""},Da="None";function Ta(e){var t=e.attributes,n=e.setAttributes,r=ga(!1),a=(0,g.Z)(r,2),o=a[0],c=a[1],l=ga(""),i=(0,g.Z)(l,2),s=i[0],f=i[1],p=ga(t.theme.pagination||{}),m=(0,g.Z)(p,2),d=m[0],b=m[1],h=ha(te).state,E=h.options,w=void 0===E?{}:E,k=h.tables,O=(void 0===k?{}:k).current,x=t.tableName,N=t.chart,C=t.dataSettings,j=ga((C||{}).perPage||10),S=(0,g.Z)(j,2),P=S[0],Z=S[1],_=N?Ca[N.name]:null,D=ka((function(){return(e=O)?((e||{}).fields||[]).reduce((function(e,t){var n=function(e){var t=(e||{}).type;switch(!0){case Za.indexOf(t)>=0:return"number";case Sa.indexOf(t)>=0:return"string";case Pa.indexOf(t)>=0:return"datetime"}}(t),r=t.name;return t.extend.isHidden||t.extend.isSystem&&"id"!==r&&"createdAt"!==r||!n||(e[r]=ya(ya({},t),{},{chartType:n})),e}),{}):{};var e}),[O]),T=Ea((function(e){var t=ya({},ja.find((function(t){return t.name===e})));if(N){var n=Ca[e];t.options=ya(ya(ya(ya({},t.options),{},{width:N.options.width,height:N.options.height},(n.titles||{}).chart?{title:N.options.title}:{}),(n.titles||{}).vAxis?{vAxis:N.options.vAxis}:{}),(n.titles||{}).hAxis?{hAxis:N.options.hAxis}:{})}return t}),[N]),I=Ea((function(e){var t=ya({},C),n=Ca[e];return t.x&&n.xType.indexOf((D[t.x]||{}).chartType)<0&&(t.x="",t.order="",t.group=""),t.y=C.y.filter((function(e){return n.yType.indexOf((D[e]||{}).chartType)>=0})),t.y.length>1&&!n.multiAxis&&(t.y=[t.y[0]]),t}),[C,D]);wa((function(){N||n({chart:ya({},ja[0])}),C||n({dataSettings:ya({},_a)})}),[N,C]),wa((function(){O&&O.tableName!==x&&n({tableName:O.tableName,dataSettings:I((N||{}).name||ja[0].name)})}),[O,x,C,D,N]);var A=ka((function(){return _&&D?Object.keys(D).filter((function(e){return C.y.indexOf(e)<0&&_.xType.indexOf((D[e]||{}).chartType)>=0})):[]}),[_,D,C]),q=ka((function(){return _&&D?Object.keys(D).filter((function(e){return C.x!==e&&_.yType.indexOf((D[e]||{}).chartType)>=0})):[]}),[_,D,C]),B=ka((function(){if(_&&C){var e=C.y.filter((function(e){return e}));return(0===e.length||_.multiAxis&&q.length-e.length>0)&&e.push(""),e}return[]}),[_,C,q]),F=Ea((function(e){var t=e.value;n({dataSettings:ya(ya({},C),{},{x:t,order:""})})}),[C]),M=Ea((function(e){var t=e.value;n({dataSettings:ya(ya({},C),{},{order:t})})}),[C]),L=Ea((function(e){var t=e.value;n({dataSettings:ya(ya({},C),{},{group:t})})}),[C]),V=Ea((function(e,t){var r=(0,ve.Z)(C.y);t?r[e]=t:r.splice(e,1),n({dataSettings:ya(ya({},C),{},{y:r.filter((function(e){return e}))})})}),[C]),z=Ea((function(e){var t=e.value;n({chart:T(t),dataSettings:I(t)})}),[N,C]),U=Ea((function(e){var t=e.target.value,r=ya(ya({},N.options),{},{title:t});n({chart:ya(ya({},N),{},{options:r})})}),[N]),H=Ea((function(e,t){var r=ya(ya({},N.options),{},(0,u.Z)({},e,{title:t}));n({chart:ya(ya({},N),{},{options:r})})}),[N]),W=C||{},J=W.x,Y=W.y,K=W.group,G=W.order,$=[{value:"",label:Da}].concat((0,ve.Z)(A.map((function(e){return{value:e,label:D[e].extend.caption}})))),X=[{value:"",label:Da}].concat((0,ve.Z)(J?[{value:"sum",label:"Sum"},{value:"avg",label:"Avg"},{value:"max",label:"Max"},{value:"min",label:"Min"},{value:"count",label:"Count"}]:[])),Q=[{value:"",label:Da}].concat((0,ve.Z)(J&&"string"===(D[J]||{}).chartType?[{value:"ASC",label:"Asc"},{value:"DESC",label:"Desc"}]:[])),ee=ja.map((function(e){var t=e.name;return{value:t,label:t}}));wa((function(){n({theme:{pagination:d}})}),[d]);var ne=R(),re=Ea((function(e){return b(e)}),[]),ae=Ea((function(e){var t=e.target.value;(t=parseInt(t))<1||t>100||(Z(t),n({dataSettings:ya(ya({},C),{},{perPage:t})}))}),[C]);return(0,v.createElement)("div",{className:Ve()(e.className,xa,"".concat(xa,"_chart"),e.isSelected&&"".concat(xa,"_selected"))},(0,v.createElement)(fr.InspectorControls,null,(0,v.createElement)(vr,{theme:d,onChange:re})),(0,v.createElement)(ie,{type:"row align vertical space between",className:"fortressdb-block-title"},(0,v.createElement)(ie,null,"Chart"),(0,v.createElement)(ie,{type:"background contain",className:"fortressdb-logo fortressdb-block-logo"})),o&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(y.Notify,{message:s,onClear:function(){return f(null)}}),w.connected?(0,v.createElement)(Oa,null,(0,v.createElement)(ie,{type:"row wrap"},(0,v.createElement)(ie,{type:"flex",className:"fortressdb-block-section",style:{marginRight:"1em"}},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Data Source"),(0,v.createElement)(ie,{type:"row wrap relative"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-section-options"},(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Table:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(In,{defaultSelected:x,onFetching:c,onError:f}))),(0,v.createElement)(ie,{className:"fortressdb-block-section"},(0,v.createElement)(ie,{className:"fortressdb-block-section-options"},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"X-Axis"),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Column:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Select,{options:$,value:$.find((function(e){return e.value===(J||"")})),onChange:F}))),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Group:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Select,{options:X,value:X.find((function(e){return e.value===(K||"")})),onChange:L}))),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Order:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Select,{options:Q,value:Q.find((function(e){return e.value===(G||"")})),onChange:M}))),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Per Page:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Input,{type:"number",value:P,onChange:ae,min:1,max:100})))),(0,v.createElement)(ie,{className:"fortressdb-block-section-options"},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Y-Axis"),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Columns:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},B.map((function(e,t){var n=q.filter((function(n){return n===e||Y.indexOf(n)<0&&(0===Y.length||1===Y.length&&0===t||D[n].chartType===(D[Y[0]]||{}).chartType)})),r=[{value:"",label:Da}].concat((0,ve.Z)(n.map((function(e){return{value:e,label:D[e].extend.caption}}))));return(0,v.createElement)("div",{key:t,style:{paddingTop:0===t?"0":"0.3em"}},(0,v.createElement)(y.Select,{key:t,options:r,value:r.find((function(t){return t.value===e})),onChange:function(e){var n=e.value;return V(t,n)}}))}))))))))),(0,v.createElement)(ie,{type:"flex",className:"fortressdb-block-section"},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Chart Settings"),(0,v.createElement)(ie,{type:"row wrap relative"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-section-options"},(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Type:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Select,{options:ee,value:ee.find((function(e){return e.value===(N||{}).name})),onChange:z}))),_&&_.titles&&(0,v.createElement)(ie,{className:"fortressdb-block-section"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-section-options"},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Labels"),_.titles.chart&&(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Title:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Input,{value:(N.options||{}).title||"",onChange:U}))),_.titles.hAxis&&(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Horizontal:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Input,{value:(N.options.hAxis||{}).title||"",onChange:function(e){return H("hAxis",e.target.value)}}))),_.titles.vAxis&&(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Vertical:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Input,{value:(N.options.vAxis||{}).title||"",onChange:function(e){return H("vAxis",e.target.value)}}))))))))),(0,v.createElement)(ie,{className:"fortressdb-block-section"},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Preview"),(0,v.createElement)(ie,{type:"row wrap relative"},O&&(0,v.createElement)(Ie,{chart:N,dataSettings:C,table:O,page:0})))):(0,v.createElement)(y.Notify,{message:ne("plugin-not-connected")}))}function Ia(e){return(0,v.createElement)("div",{className:"fortressdb-block fortressdb-block_edit fortressdb-block_chart"},(0,v.createElement)(ee,null,(0,v.createElement)(ne,null,(0,v.createElement)(Ta,e))))}Ta.displayName="EditForm",Ia.displayName="Edit";var Aa="fortressdb-block-chart";function qa(e){var t=e.attributes;return(0,v.createElement)("div",{className:Aa,"data-attributes":JSON.stringify(t)})}qa.displayName="Save";var Ba=E().useContext,Fa=E().useEffect,Ma=E().useState,Ra="fortressdb-view-block",La=new U("metadata");function Va(e){var t=e.attributes,n=t.tableName,r=t.chart,a=t.dataSettings,o=t.theme,c=void 0===o?{}:o,l=Ba(te).state.options,i=Ma(!1),s=(0,g.Z)(i,2),u=s[0],f=s[1],p=Ma(null),m=(0,g.Z)(p,2),d=m[0],b=m[1],E=Ma(null),w=(0,g.Z)(E,2),k=w[0],O=w[1],x=Ma(0),N=(0,g.Z)(x,2),C=N[0],S=N[1],P=Ma(0),Z=(0,g.Z)(P,2),_=Z[0],D=Z[1],T=(l||{}).connected;Fa((function(){if(n&&T)return f(!0),La.subscribe({filter:{where:j.query.op("=","tableName",j.query.val(n))}},(function(e,t){if(t)b(t.message);else{var r=e.rows.find((function(e){return e.tableName===n}));if(!r)throw new Error("Selected table is not found");O(r),b(null)}})).catch((function(e){b(e.message)})).finally((function(){f(!1)})),function(){La.unsubscribe()}}),[n,T]);var I=R(),A=(0,h.useCallback)((function(e){return D(e)}),[]),q=(0,h.useCallback)((function(e){return S(e)}),[]);return(0,v.createElement)("div",{className:"fortressdb-block fortressdb-block_view fortressdb-block_chart"},(0,v.createElement)(ne,null,(0,v.createElement)("div",{className:Ve()(e.className,Ra,"".concat(Ra,"_chart"))},u&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(y.Notify,{message:d,onClear:function(){return b(null)}}),T?k&&(0,v.createElement)(h.Fragment,null,(0,v.createElement)(Ie,{chart:r,dataSettings:a,table:k,page:C,onTotalCountChange:A}),(0,v.createElement)(or.Provider,{value:c.pagination||ar},(0,v.createElement)(ur,{page:C,perPage:a.perPage||10,totalObjects:_,onPageChange:q}))):(0,v.createElement)(y.Notify,{message:I("plugin-not-connected")}))))}Va.displayName="View";var za=E().useContext,Ua=E().useState,Ha=E().useCallback,Wa=E().useRef,Ja=E().useEffect,Ya="fortressdb-edit-block",Ka=new U("licenses");function Ga(e){var t=za(te).state.options,n=Ua(!1),r=(0,g.Z)(n,2),a=r[0],o=r[1],c=Ua(""),l=(0,g.Z)(c,2),i=l[0],s=l[1],u=Ua([]),f=(0,g.Z)(u,2),p=f[0],m=f[1],d=Ua(null),b=(0,g.Z)(d,2),h=b[0],E=b[1],w=Ua(!1),k=(0,g.Z)(w,2),O=k[0],x=k[1],N=Ua(B),C=(0,g.Z)(N,2),j=C[0],S=C[1],P=Wa({updateLicenses:function(e,t){t?s(t.message):m(e.plans||[])}}),Z=P.current;Ja((function(){if(t&&t.connected)return o(!0),Ka.subscribe({context:{location:j}},Z.updateLicenses).then((function(){o(!1)})).catch((function(e){o(!1),s(e.message)})),function(){Ka.unsubscribe()}}),[t,j]);var _=R(),D=Ha((function(e){var t=e.value;S(t)}),[]),T=Ha((function(e){E(e)}),[]),I=Ha((function(e){x(e)}));return(0,v.createElement)("div",{className:Ve()(e.className,Ya,"".concat(Ya,"_price"),e.isSelected&&"".concat(Ya,"_selected"))},(0,v.createElement)(ie,{type:"row align vertical space between",className:"fortressdb-block-title"},(0,v.createElement)(ie,null,"Price List"),(0,v.createElement)(ie,{type:"background contain",className:"fortressdb-logo fortressdb-block-logo"})),t.connected?(0,v.createElement)(ie,{className:"fortressdb-block-section"},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Preview"),p.length>0&&(0,v.createElement)(ie,{type:"col content",style:{margin:"auto"}},(0,v.createElement)(ie,{type:"row flex align vertical space between"},(0,v.createElement)(ie,{type:"row align vertical space between",style:{minWidth:"16em"}},(0,v.createElement)(ie,{style:{marginRight:"0.5em"}},_("db-location")),(0,v.createElement)(ie,{style:{width:"7em"}},(0,v.createElement)(y.Select,{options:q,value:q.find((function(e){return e.value===j})),onChange:D}))),(0,v.createElement)(ie,null,(0,v.createElement)(be,{onDiscount:T,onFetching:I}))),(0,v.createElement)(ie,{type:"row",className:"fortressdb-block-price-content"},p.map((function(e,t){return(0,v.createElement)(Yn,{key:e.name,plan:e,planNumber:t+1,discount:h,disabled:O})})))),a&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(y.Notify,{message:i,onClear:function(){return s(null)}})):(0,v.createElement)(y.Notify,{message:_("plugin-not-connected")}))}function $a(e){return(0,v.createElement)("div",{className:"fortressdb-block fortressdb-block_edit fortressdb-block_price"},(0,v.createElement)(ee,null,(0,v.createElement)(ne,null,(0,v.createElement)(Ga,e))))}Ga.displayName="EditForm",$a.displayName="Edit";var Xa="fortressdb-block-price";function Qa(e){var t=e.attributes;return(0,v.createElement)("div",{className:Xa,"data-attributes":JSON.stringify(t)})}Qa.displayName="Save";var eo=E().useContext,to=E().useCallback,no=E().useState,ro="fortressdb-block-register-form";function ao(e){var t=eo(y.Popup.Context),n=R(),r=no(!1),a=(0,g.Z)(r,2),o=a[0],c=a[1],l=no(""),i=(0,g.Z)(l,2),s=i[0],u=i[1],f=no(e.email||""),p=(0,g.Z)(f,2),m=p[0],d=p[1],b=no(e.name||""),h=(0,g.Z)(b,2),E=h[0],k=h[1],O=no(e.password||""),x=(0,g.Z)(O,2),N=x[0],j=x[1],S=no(!!e.agreePolicy),P=(0,g.Z)(S,2),Z=P[0],_=P[1],D=to((function(e){var t=e.target.value;d(t)}),[]),T=to((function(e){var t=e.target.value;k(t)}),[]),I=to((function(e){var t=e.target.value;j(t)}),[]),A=to((function(e){var t=e.target.checked;_(t)}),[]),q=to((0,w.Z)(C().mark((function n(){return C().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c(!0),n.prev=1,n.next=4,e.onSubmit&&e.onSubmit({email:m,name:E,password:N});case 4:t(),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(1),u(n.t0.message),c(!1);case 11:case"end":return n.stop()}}),n,null,[[1,7]])}))),[m,E,N,e.onSubmit,t]),B=m&&E&&N&&Z;return(0,v.createElement)("div",{className:ro},(0,v.createElement)("div",{className:"".concat(ro,"__property")},(0,v.createElement)("div",{className:"".concat(ro,"__property-label")},n("name")),(0,v.createElement)(y.Input,{className:"".concat(ro,"__input"),type:"text",value:E,onChange:T})),(0,v.createElement)("div",{className:"".concat(ro,"__property")},(0,v.createElement)("div",{className:"".concat(ro,"__property-label")},n("email")),(0,v.createElement)(y.Input,{className:"".concat(ro,"__input"),type:"email",value:m,onChange:D})),(0,v.createElement)("div",{className:"".concat(ro,"__property")},(0,v.createElement)("div",{className:"".concat(ro,"__property-label")},n("password")),(0,v.createElement)(y.Input,{className:"".concat(ro,"__input"),type:"password",value:N,onChange:I})),(0,v.createElement)("div",{className:"".concat(ro,"__policy")},(0,v.createElement)(y.Input,{className:"".concat(ro,"__checkbox"),type:"checkbox",checked:Z,onChange:A}),(0,v.createElement)("div",{className:"".concat(ro,"__agreement")},n("agreement"))),(0,v.createElement)("div",{className:"".concat(ro,"__buttons")},(0,v.createElement)(y.Button,{className:"".concat(ro,"__button_submit"),onClick:q,disabled:!B},n("submit")),(0,v.createElement)(y.Button,{className:"".concat(ro,"__button_cancel"),onClick:t},n("cancel"))),o&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(y.Notify,{message:s,onClear:function(){return u(null)}}))}ao.displayName="RegisterForm";var oo=E().useContext,co="fortressdb-block-email-notification";function lo(e){var t=oo(y.Popup.Context),n=R();return(0,v.createElement)("div",{className:co},(0,v.createElement)("div",{className:"".concat(co,"__emailing")},n("pay-emailing")),(0,v.createElement)("div",{className:"".concat(co,"__buttons")},(0,v.createElement)(y.Button,{className:"".concat(co,"__button_close"),onClick:t},n("close"))))}lo.displayName="EmailNotification";var io=E().useContext;function so(){var e=io(y.Popup.Context),t=R();return(0,v.createElement)(ie,{type:"col relative",style:{maxWidth:"30em",padding:"0.25em"}},(0,v.createElement)(ie,{type:"row"},t("install-plugin")),(0,v.createElement)(ie,{type:"row",style:{paddingTop:"0.75em"}},(0,v.createElement)(y.Button,{onClick:e},t("close"))))}so.displayName="ThanksNotification";var uo=E().Fragment,fo=E().useContext,po=E().useState,mo=E().useRef,bo=E().useEffect,vo=E().useCallback,yo="fortressdb-view-block",go="payment",ho="coupon",Eo="success",wo="PAYMENT_SUCCESS",ko="REGISTER_FORM",Oo="EMAIL_NOTIFICATION",xo=new U("licenses");function No(e){var t=fo(te).state.options,r=po(!1),a=(0,g.Z)(r,2),o=a[0],c=a[1],l=po(""),i=(0,g.Z)(l,2),s=i[0],u=i[1],f=po([]),p=(0,g.Z)(f,2),m=p[0],d=p[1],b=po(null),h=(0,g.Z)(b,2),E=h[0],k=h[1],O=po(B),x=(0,g.Z)(O,2),N=x[0],j=x[1],S=po(null),P=(0,g.Z)(S,2),Z=P[0],_=P[1],D=po(!1),T=(0,g.Z)(D,2),I=T[0],A=T[1],L=po(!1),V=(0,g.Z)(L,2),U=V[0],H=V[1],W=po(""),J=(0,g.Z)(W,2),Y=J[0],K=J[1],G=z().setTimeout,$=mo({updateLicenses:function(e,t){t?u(t.message):d(e.plans||[])}}),X=$.current;bo((function(){if(t&&t.connected)return c(!0),xo.subscribe({context:{location:N}},X.updateLicenses).then((function(){c(!1)})).catch((function(e){c(!1),u(e.message)})),function(){xo.unsubscribe()}}),[t,N]);var Q=R(),ee=vo((function(e){var t=e.value;j(t)}),[]),re=vo((function(e){_(e)}),[]),ae=vo((function(e){A(e)})),oe=vo(function(){var e=(0,w.Z)(C().mark((function e(t){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(t),H(ko);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ce=vo(function(){var e=(0,w.Z)(C().mark((function e(t,n){var r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!n){e.next=10;break}return e.next=3,M(n);case 3:if(r=e.sent){e.next=6;break}throw new Error("Stripe service is unavailable.");case 6:return e.next=8,r.redirectToCheckout({sessionId:t});case 8:e.next=11;break;case 10:throw new Error("Stripe session error.");case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[]),le=vo(function(){var e=(0,w.Z)(C().mark((function e(t){var r,a,o,c,l,i,s,u;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.email,a=t.name,o=t.password,c=n.g.location,l=c.href,i=c.search,e.next=4,F.W.post("payments-session",{data:[{plan:E,coupon:(Z||{}).id||"",email:r,location:N,success:"".concat(l).concat(i?"&":"?").concat(Eo),cancel:l}],context:{}});case 4:return s=e.sent,u=s.licenseUuid,e.next=8,F.W.post("auth-signup",{data:[{email:r,password:o,name:a,url:"".concat(l).concat(i?"&":"?").concat(go,"=").concat(encodeURI(u))}],context:{locale:"en"}});case 8:G((function(){H(Oo)}),0);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[E,N]),se=vo((function(e){var t=n.g.location,r=t.origin,a=t.pathname,o=new URLSearchParams(n.g.location.search);o.delete(e);var c=o.toString(),l=r+a+(c?"?".concat(c):"");n.g.history.replaceState(n.g.history.state,"",l)}),[n.g.location]),ue=vo((function(e){H(!1)}),[]);bo((function(){var e,t=new URLSearchParams(n.g.location.search);t.has(ho)&&(K(t.get(ho)),se(ho)),t.has(Eo)&&(H(wo),se(Eo)),t.has(go)&&((e=(0,w.Z)(C().mark((function e(t){var n,r,a,o;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.prev=1,e.next=4,F.W.get("licenses-byUuid",{filter:{where:{uuid:t}}});case 4:return n=e.sent,r=(n[0]||{}).data||{},a=r.checkout_session_id,o=r.stripe_publishable_key,e.next=8,ce(a,o);case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),c(!1),u(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),function(t){return e.apply(this,arguments)})(decodeURI(t.get(go))),se(go))}),[n.g.location.search,se]);var fe=(t||{}).connected;return(0,v.createElement)("div",{className:"fortressdb-block fortressdb-block_view fortressdb-block_price"},(0,v.createElement)(ne,null,(0,v.createElement)(y.Popup.Switcher,{active:U,onClose:ue},(0,v.createElement)(so,{popup:{id:wo,title:Q("payment-success")}}),(0,v.createElement)(ao,{popup:{id:ko,title:Q("payment-registration")},onSubmit:le}),(0,v.createElement)(lo,{popup:{id:Oo,title:Q("payment-registration")}})),(0,v.createElement)("div",{className:Ve()(e.className,yo,"".concat(yo,"_price"))},fe?(0,v.createElement)(uo,null,m.length>0&&(0,v.createElement)(uo,null,(0,v.createElement)(ie,{type:"row flex align vertical space between"},(0,v.createElement)(ie,{type:"row align vertical space between",style:{minWidth:"16em"}},(0,v.createElement)(ie,{style:{marginRight:"0.5em"}},Q("db-location")),(0,v.createElement)(ie,{style:{width:"7em"}},(0,v.createElement)(y.Select,{options:q,value:q.find((function(e){return e.value===N})),onChange:ee}))),(0,v.createElement)(ie,null,(0,v.createElement)(be,{onDiscount:re,onFetching:ae,code:Y}))),(0,v.createElement)(ie,{type:"row",className:"fortressdb-block-price-content"},m.map((function(e,t){return(0,v.createElement)(Yn,{key:e.name,plan:e,planNumber:t+1,discount:Z,disabled:I,onPay:oe})})))),o&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(y.Notify,{message:s,onClear:function(){return u(null)}})):(0,v.createElement)(y.Notify,{message:Q("plugin-not-connected")}))))}function Co(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Co(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Co(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function So(e,t,n){return Po.apply(this,arguments)}function Po(){return Po=(0,w.Z)(C().mark((function e(t,n,r){var a;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.source){e.next=2;break}return e.abrupt("return",null);case 2:return a=t.source,e.next=5,Promise.all(t.fields.map(function(){var e=(0,w.Z)(C().mark((function e(t){var o,c,l,i,s,u,f,p;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=n[t.name],e.t0=t.type,e.next="enum"===e.t0?4:"file"===e.t0?7:23;break;case 4:return c=r[t.extend.enumId]||[],o=(o?Array.isArray(o)?o:[o]:[]).map((function(e){return(c.find((function(t){return t.id===e}))||{}).label||e})).join(", "),e.abrupt("break",23);case 7:if(l=o?Array.isArray(o)?o:[o]:[],o="",!l.length){e.next=22;break}if(i=l[0],s=i.type,u=i.name,"string"!=typeof s||!s.startsWith("image")){e.next=20;break}return e.next=16,(0,I.q)(i,"thumb");case 16:f=e.sent,o='<img src="'.concat(f,"\" style='width: auto; height: auto;'/>"),e.next=22;break;case 20:p=JSON.stringify(i).replace(/"/g,"'"),o='<a href="javascript:fortressdb.file.download('.concat(p,')" title="download">').concat(u,"</a>");case 22:return e.abrupt("break",23);case 23:a=a.replace("${".concat(t.name,"}"),o);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)}))),Po.apply(this,arguments)}function Zo(e,t){var n=e&&t&&e.match(/(\${[\w]+})/gm);return{source:e,fields:n?n.reduce((function(e,n,r){var a=n.substr(2,n.length-3);if(a){var o=t.fields.find((function(e){return e.name===a}));o&&e.push(o)}return e}),[]):[]}}function _o(e){var t=e.split(",").map((function(e){return e.trim()})),n=Math.min.apply(Math,(0,ve.Z)(t.map((function(e){return e.length})))),r=t.length>1?t.find((function(e){return e.length===n})):null,a=t.length>1?t.find((function(e){return e.length!==n})):t[0],o={};return r&&(o=jo(jo({},o),{},{country:r})),a&&(o=jo(jo({},o),{},{postalCode:a})),o}function Do(e,t,n){return To.apply(this,arguments)}function To(){return To=(0,w.Z)(C().mark((function e(t,r,a){var o,c,l,i,s,f,p,m;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r.type,e.next=e.t0===qo?3:e.t0===Bo||e.t0===Fo?6:26;break;case 3:if(c=t[r.field])if("string"==typeof c)try{o=JSON.parse(c)}catch(e){}else"object"===(0,ye.Z)(c)&&(o=c);return e.abrupt("break",26);case 6:if(l=Mo(r.field),void 0===(i=t[l])){e.next=25;break}if("string"!=typeof(s=t[r.field])){e.next=25;break}if(!(s=s.trim())){e.next=25;break}if(!(f=(i||{})[r.type])||f.search!==s){e.next=18;break}o=f.location,e.next=25;break;case 18:return p=new n.g.google.maps.Geocoder,m=r.type===Bo?{componentRestrictions:_o(s)}:{address:s},e.next=22,Promise.all([new Promise((function(e,t){p.geocode(m,(function(n,r){"OK"===r?e(n[0].geometry.location):t(new Error("".concat(s," geocode was not successful for the following reason: ").concat(r)))}))})),new Promise((function(e){setTimeout(e,200)}))]).then((function(e){return e[0]}));case 22:return o=e.sent,e.next=25,a.put([jo(jo({},t),{},(0,u.Z)({},l,jo(jo({},i||{}),{},(0,u.Z)({},r.type,{search:s,location:o}))))]);case 25:return e.abrupt("break",26);case 26:return e.abrupt("return","object"===(0,ye.Z)(o)&&Number.isFinite(o.lat)&&Number.isFinite(o.lng)?o:void 0);case 27:case"end":return e.stop()}}),e)}))),To.apply(this,arguments)}function Io(e,t,n,r,a){return Ao.apply(this,arguments)}function Ao(){return Ao=(0,w.Z)(C().mark((function e(t,n,r,a,o){var c,l;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Do(t,n,r);case 2:if(c=e.sent,l=null,!c){e.next=8;break}return e.next=7,So(a,t,o);case 7:l=e.sent;case 8:return e.abrupt("return",{position:c,info:l});case 9:case"end":return e.stop()}}),e)}))),Ao.apply(this,arguments)}No.displayName="View";var qo="position",Bo="postcode",Fo="address";function Mo(e){return"_".concat(e,"_geocode")}function Ro(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ro(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ro(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Vo="fortressdb-edit-block",zo=E().useState,Uo=E().useContext,Ho=E().useCallback,Wo=E().useEffect,Jo=E().useRef,Yo=E().useMemo,Ko=E().Fragment,Go=new T.F("options"),$o=[{value:qo,label:"Coordinates (lat/lng)"},{value:Bo,label:"Postcode"},{value:Fo,label:"Address"}],Xo=new U("objects"),Qo=new U("enum_values");function ec(e){var t=e.attributes,n=e.setAttributes,r=t.tableName,a=t.mapLocation,o=t.infoWindow,c=zo(!1),l=(0,g.Z)(c,2),i=l[0],s=l[1],u=zo(""),f=(0,g.Z)(u,2),p=f[0],m=f[1],d=zo([]),b=(0,g.Z)(d,2),h=b[0],E=b[1],k=zo([]),O=(0,g.Z)(k,2),x=O[0],N=O[1],j=zo({}),S=(0,g.Z)(j,2),P=S[0],Z=S[1],_=zo([]),D=(0,g.Z)(_,2),T=D[0],I=D[1],A=zo(10),q=(0,g.Z)(A,2),B=q[0],F=q[1],M=zo([]),V=(0,g.Z)(M,2),z=V[0],U=V[1],H=zo(t.theme.search||{}),W=(0,g.Z)(H,2),J=W[0],Y=W[1],K=zo(t.theme.pagination||{}),G=(0,g.Z)(K,2),$=G[0],X=G[1],Q=zo(t.theme.labels||[]),ee=(0,g.Z)(Q,2),ne=ee[0],re=ee[1],ae=zo(t.theme.labelStyle||"vertical"),oe=(0,g.Z)(ae,2),ce=oe[0],le=oe[1],se=Uo(te),ue=se.state,fe=ue.options,pe=ue.tables,me=void 0===pe?{}:pe,de=se.dispatch,be=me.current,ye=me.watcher,ge=zo(fe&&fe.googleApiKey||""),he=(0,g.Z)(ge,2),Ee=he[0],we=he[1],ke=zo((a||{}).type||qo),Oe=(0,g.Z)(ke,2),xe=Oe[0],Ne=Oe[1],Ce=Jo(null),je=Jo({objectsUpdate:function(e,t){if(t)m(t.message);else{var n=e.rows;N(n)}},enumValuesUpdate:function(e,t){t?m(t.message):Z(Object.keys(e).reduce((function(t,n){return t[n]=e[n].rows,t}),{}))}}),Se=je.current,Pe=L(be);Wo((function(){return function(){Xo.unsubscribe(),Qo.unsubscribe()}}),[]),Wo((function(){if(be&&Pe!==be){s(!0);var e=[Xo.subscribe({context:{tableName:be.tableName}},Se.objectsUpdate)],t=be.fields.filter((function(e){return"enum"===e.type})).map((function(e){return e.extend.enumId}));t.length?e.push(Qo.subscribe({context:{enumId:t}},Se.enumValuesUpdate)):Qo.unsubscribe(),Promise.all(e).catch((function(e){m(e.message)})).finally((function(){s(!1)}))}})),Wo((function(){be&&be.tableName!==r&&n({tableName:be.tableName,mapLocation:{}})}),[be,r]);var Ze=R(),_e=!(!fe||!fe.connected);Wo((function(){_e||m(Ze("plugin-not-connected"))}),[_e]),Wo((function(){be&&E((0,ve.Z)(be.fields).filter((function(e){return!e.extend.isHidden})).sort((function(e,t){return e.extend.order-t.extend.order})).map((function(e){return{value:e.name,label:e.extend.caption}})))}),[be]);var De=Yo((function(){return Zo(o,be)}),[o,be]);Wo((function(){a&&a.field&&x.length?(s(!0),Promise.all(x.map((function(e){return Io(e,a,Xo,De,P)}))).then(I).catch((function(e){m(e.message)})).finally((function(){s(!1)}))):I([])}),[a&&a.field,a&&a.type,x,P,De]),Wo((function(){be&&U(Re.filter((function(e){var n=e.value;return t.searchFields.includes(n)})))}),[be]);var Te=Ho((function(e){var t=e.value;t===qo&&n({mapLocation:Lo(Lo({},a||{}),{},{type:t})}),Ne(t)}),[a]),Ie=Ho(function(){var e=(0,w.Z)(C().mark((function e(t){var r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.value,n({mapLocation:Lo(Lo({},a||{}),{},{field:r,type:qo})}),Ne(qo);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[a,be]),Ae=Ho((function(e){var t=e.target.value;n({infoWindow:t})}),[]),qe=Ho((0,w.Z)(C().mark((function e(){var t,r,o;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(be&&xe&&a&&a.field)){e.next=17;break}if(s(!0),e.prev=2,xe===qo){e.next=10;break}if(t=be.fields,r=t.find((function(e){return e.name===a.field})),o=Mo(r.name),t.find((function(e){return e.name===o}))){e.next=10;break}return e.next=10,ye.put([{fields:[].concat((0,ve.Z)(t),[{name:o,type:"json",extend:{isHidden:!0,caption:"".concat(r.extend.caption," (Geocode)")}}]),id:be.id}]);case 10:n({mapLocation:Lo(Lo({},a||{}),{},{type:xe})}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),m(e.t0.message);case 16:s(!1);case 17:case"end":return e.stop()}}),e,null,[[2,13]])}))),[be,xe,a&&a.field]),Be=Ho((function(e){var t=e.value,r=Ce.current,a=r.selectionStart,o=r.selectionEnd,c=r.value,l="${".concat(t,"}");r.value=c.substr(0,a)+l+c.substr(a),r.selectionStart=a+l.length,r.selectionEnd=o+l.length,n({infoWindow:r.value})}),[]);Wo((function(){fe&&fe.googleApiKey&&we(fe.googleApiKey)}),[fe]);var Fe=Ho((function(e){var t=e.target.value;(t=parseInt(t))<1||t>100||(F(t),n({perPage:t}))}),[]),Me=Ho((function(e){var t=null===e?[]:e;U(t),n({searchFields:t.map((function(e){return e.value}))})}),[]),Re=Yo((function(){var e=["text","string","enum"];return be?(0,ve.Z)(be.fields).filter((function(t){return!t.extend.isHidden&&e.includes(t.type)})).sort((function(e,t){return e.extend.order-t.extend.order})).map((function(e){return{value:e.name,label:e.extend.caption}})):[]}),[be]),Le=fe&&fe.googleApiKey&&fe.googleApiKey!==Ee,ze=Ho((0,w.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ee){e.next=2;break}return e.abrupt("return");case 2:return s(!0),e.prev=3,e.next=6,Go.put({options:{googleApiKey:Ee}}).json();case 6:t=e.sent,Le?m((0,v.createElement)(Ko,null,"Save success.",(0,v.createElement)("br",null),"To apply new API key you have to reload the page.")):de({options:t}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),m(e.t0.message);case 13:return e.prev=13,s(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[3,10,13,16]])}))),[Ee,Le]),Ue=!fe||!fe.googleApiKey,He=(a||{}).field&&xe!==qo&&xe!==(a||{}).type,We=Ho((function(e){return Y(e)}),[]),Je=Ho((function(e){return X(e)}),[]),Ye=Ho((function(e){return re(e)}),[]),Ke=Ho((function(e){return le(e)}),[]);return Wo((function(){n({theme:{pagination:$,search:J,labels:ne,labelStyle:ce}})}),[J,$,ne,ce]),(0,v.createElement)("div",{className:Ve()(e.className,Vo,"".concat(Vo,"_map"),e.isSelected&&"".concat(Vo,"_selected"))},i&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(fr.InspectorControls,null,(0,v.createElement)(vr,{theme:$,onChange:Je}),(0,v.createElement)(Er,{theme:J,onChange:We}),(0,v.createElement)(Lr,{tableFields:(be||{fields:[]}).fields.filter((function(e){var t=e.name;return!!z.find((function(e){return e.value===t}))})),labels:ne,labelStyle:ce,onChange:Ye,onLabelStyleChange:Ke})),(0,v.createElement)(y.Notify,{message:p,onClear:function(){return m(null)}}),(0,v.createElement)(ie,{type:"row align vertical space between",className:"fortressdb-block-title"},(0,v.createElement)(ie,null,"Map"),(0,v.createElement)(ie,{type:"background contain",className:"fortressdb-logo fortressdb-block-logo"})),_e&&(0,v.createElement)(Ko,null,(0,v.createElement)(ie,{type:"row wrap"},(0,v.createElement)(ie,{type:"flex",className:"fortressdb-block-section"},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Google API Key"),(0,v.createElement)(ie,{type:"row wrap relative"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-section-options"},(0,v.createElement)(ie,{type:"row"},(0,v.createElement)(y.Input,{disabled:i,value:Ee,onChange:function(e){var t=e.target.value;we(t)},style:{marginRight:"4px",width:"25em"}}),(0,v.createElement)(y.Button,{disabled:i||!Ee||Ee===(fe||{}).googleApiKey,onClick:ze},"Submit")),(0,v.createElement)(y.Link,{href:"https://help.fortressdb.com/knowledge-base/google-maps-block/",target:"_blank"},"How to get an API key?"))))),!Ue&&(0,v.createElement)(Ko,null,(0,v.createElement)(ie,{type:"row wrap"},(0,v.createElement)(ie,{className:"fortressdb-block-section",style:{marginRight:"1em"}},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Data Source"),(0,v.createElement)(ie,{type:"row wrap relative"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-section-options"},(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Table:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(In,{defaultSelected:r,onFetching:s,onError:m}))),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Per Page:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Input,{type:"number",value:B,onChange:Fe,min:1,max:100}))),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Search by:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Select,{options:Re,value:z,isMulti:!0,isClearable:!0,onChange:Me}))),(0,v.createElement)(ie,{className:"fortressdb-block-section"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-section-options"},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Location"),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Column:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Select,{options:h,value:a&&a.field&&h.find((function(e){return e.value===a.field})),onChange:Ie}))),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Type:"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Select,{options:$o,value:$o.find((function(e){return e.value===xe})),onChange:Te}))),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"}),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},He&&(0,v.createElement)(y.Button,{onClick:qe},"Apply Geocoding")))))))),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-section"},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Info Window"),(0,v.createElement)(ie,{type:"col flex",className:"fortressdb-block-option"},(0,v.createElement)(y.Textarea,{innerRef:Ce,value:o,onChange:Ae,style:{height:"154px",width:"320px"}}),(0,v.createElement)(y.Select,{options:h,value:null,onChange:Be,className:"fortressdb-button-insert-field"})))),(0,v.createElement)(ie,{className:"fortressdb-block-section"},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Preview"),(0,v.createElement)(ie,{type:"col relative"},(0,v.createElement)(y.Map,{markers:T,apiKey:Ee}))))))}function tc(e){return(0,v.createElement)("div",{className:"fortressdb-block fortressdb-block_edit fortressdb-block_chart"},(0,v.createElement)(ee,null,(0,v.createElement)(ne,null,(0,v.createElement)(ec,e))))}ec.displayName="EditForm",tc.displayName="Edit";var nc="fortressdb-block-map";function rc(e){var t=e.attributes;return(0,v.createElement)("div",{className:nc,"data-attributes":JSON.stringify(t)})}function ac(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ac(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ac(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}rc.displayName="Save";var cc=E().useContext,lc=E().useEffect,ic=E().useState,sc=E().useRef,uc=E().useMemo,fc=E().Fragment,pc="fortressdb-view-block",mc=new U("metadata"),dc=new U("objects"),bc=new U("enum_values");function vc(e){var t=e.attributes,n=t.tableName,r=t.mapLocation,a=t.infoWindow,o=t.perPage,c=void 0===o?10:o,l=t.searchFields,i=void 0===l?[]:l,s=t.theme,u=void 0===s?{}:s,f=ic(null),p=(0,g.Z)(f,2),m=p[0],d=p[1],b=ic([]),E=(0,g.Z)(b,2),w=E[0],k=E[1],O=ic({}),x=(0,g.Z)(O,2),N=x[0],C=x[1],S=ic([]),P=(0,g.Z)(S,2),Z=P[0],_=P[1],D=cc(te).state.options,T=ic(!1),I=(0,g.Z)(T,2),A=I[0],q=I[1],B=ic(null),F=(0,g.Z)(B,2),M=F[0],L=F[1],V=ic({limit:c,page:0}),z=(0,g.Z)(V,2),U=z[0],H=z[1],W=ic(0),J=(0,g.Z)(W,2),Y=J[0],K=J[1],G=sc({metadataUpdate:function(e,t){if(t)L(t.message);else{var r=e.rows.find((function(e){return e.tableName===n}));if(!r)throw new Error("Selected table is not found");d(r)}},objectsUpdate:function(e,t){if(t)L(t.message);else{var n=e.rows,r=e.count;K(r),k(n)}},enumValuesUpdate:function(e,t){t?L(t.message):C(Object.keys(e).reduce((function(t,n){return t[n]=e[n].rows,t}),{}))}}),$=G.current,X=!(!D||!D.connected);lc((function(){if(n&&X)return q(!0),mc.subscribe({filter:{where:j.query.op("=","tableName",j.query.val(n))}},$.metadataUpdate).catch((function(e){L(e.message)})).finally((function(){q(!1)})),function(){mc.unsubscribe()}}),[n,X]),lc((function(){if(m){q(!0);var e={};if(U.limit&&(e.limit=U.limit,e.offset=U.limit*U.page),U.where){var t=Object.entries(U.where).filter((function(e){var t=(0,g.Z)(e,2),n=t[0],r=t[1];return n&&r})).map((function(e){var t=(0,g.Z)(e,2),n=t[0],r=t[1];if(n&&r){var a=m.fields.find((function(e){return e.name===n}));if(!a)return null;if("string"===a.type||"text"===a.type)return j.query.op("iLike",n,j.query.val("%".concat(r,"%")));if("enum"===a.type){var o=r.map((function(e){return parseInt(e)}));return o.length>0?j.query.op("contains",n,j.query.val(o)):null}return null}})).filter((function(e){return!!e}));t.length>0&&(e.where=1===t.length?t[0]:j.query.op.apply(j.query,["and"].concat((0,ve.Z)(t))))}var n=[dc.subscribe({context:{tableName:m.tableName},filter:e},$.objectsUpdate)],r=m.fields.filter((function(e){return"enum"===e.type})).map((function(e){return e.extend.enumId}));return r.length?n.push(bc.subscribe({context:{enumId:r}},$.enumValuesUpdate)):bc.unsubscribe(),Promise.all(n).catch((function(e){L(e.message)})).finally((function(){q(!1)})),function(){dc.unsubscribe(),bc.unsubscribe()}}}),[m,U]);var Q=R();lc((function(){D&&!X&&L(Q("plugin-not-connected"))}),[D,X]);var ee=uc((function(){return Zo(a,m)}),[a,m]);lc((function(){r&&r.field&&w.length?(q(!0),Promise.all(w.map((function(e){return Io(e,r,dc,ee,N)}))).then(_).catch((function(e){L(e.message)})).finally((function(){q(!1)}))):_([])}),[r,w,N,ee]);var re=D&&D.googleApiKey||"",ae=(0,h.useCallback)((function(e){return H(oc(oc({},U),{},{page:e}))}),[]);return(0,v.createElement)("div",{className:"fortressdb-block fortressdb-block_view fortressdb-block_chart"},(0,v.createElement)(ne,null,(0,v.createElement)("div",{className:Ve()(e.className,pc,"".concat(pc,"_map"))},A&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(y.Notify,{message:M,onClear:function(){return L(null)}}),X&&(0,v.createElement)(fc,null,(0,v.createElement)(wr.Provider,{value:u.search||yr},(0,v.createElement)(Br,{type:u.labelStyle,labels:u.labels||{},table:m,searchableFields:i,enumValues:N,onChange:function(e){return H(oc(oc({},U),{},{where:e,page:0}))}})),(0,v.createElement)(y.Map,{markers:Z,apiKey:re}),(0,v.createElement)(or.Provider,{value:u.pagination||ar},(0,v.createElement)(ur,{page:U.page,perPage:U.limit,totalObjects:Y,onPageChange:ae}))))))}vc.displayName="View";var yc=n(1609),gc=n.n(yc),hc=E().useMemo;function Ec(e){var t=wp.components,n=t.Panel,r=t.PanelBody,a=t.PanelRow,o=t.Button,c=t.TextControl,l=t.Flex,i=t.FlexItem,s=t.SelectControl,u=e.variableMap,f=e.onChange,p=e.table,m=hc((function(){return p?[{value:null,label:"None"}].concat((0,ve.Z)(p.fields).filter((function(e){return!e.extend.isHidden})).sort((function(e,t){return e.extend.order-t.extend.order})).map((function(e){return{value:e.name,label:e.extend.caption}}))):[]}),[p]),d=function(e){f(e)},b=function(e){return function(t){var n=(0,ve.Z)(u);n[e].variable=t,d(n)}},y=function(e){return function(t){var n=(0,ve.Z)(u);n[e].field=t,d(n)}},g=function(e){return function(){var t=(0,ve.Z)(u);t.splice(e,1),d(t)}};return(0,v.createElement)(n,null,(0,v.createElement)(r,{title:"Variable mappings",initialOpen:!0},u.map((function(e,t){var n=e.variable,r=e.field;return(0,v.createElement)(a,{key:t},(0,v.createElement)(l,null,(0,v.createElement)(i,null,(0,v.createElement)(c,{value:n,onChange:b(t)})),(0,v.createElement)(i,null,(0,v.createElement)(s,{isEmpty:!0,options:m,value:r,onChange:y(t)})),(0,v.createElement)(i,null,(0,v.createElement)(o,{isTertiary:!0,isDestructive:!0,isSmall:!0,icon:"no",onClick:g(t)}))))})),(0,v.createElement)(a,null,(0,v.createElement)(o,{isPrimary:!0,onClick:function(){d((0,ve.Z)(u).concat([{variable:"",field:null}]))}},"Add variable"))))}Ec.displayName="VariableMapControl";var wc=E().useState,kc=E().Fragment,Oc=E().useEffect,xc=E().useContext,Nc=E().useMemo,Cc=["text","string","enum"];function jc(e){if(navigator.clipboard&&n.g.isSecureContext)return navigator.clipboard.writeText(e);var t=document.createElement("textarea");return t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select(),new Promise((function(e,n){document.execCommand("copy")?e():n(),t.remove()}))}function Sc(e){var t=e.rowCount,n=void 0===t?10:t,r=e.onRowCountChange,a=void 0===r?function(){}:r,o=(e.columnCount,e.onColumnCountChange,e.isSingleItem),c=void 0!==o&&o,l=e.onIsSingleItemChange,i=void 0===l?function(){}:l,s=e.tableName,u=e.onTableChange,f=void 0===u?function(){}:u,p=e.variableMap,m=void 0===p?[]:p,d=e.searchOptions,b=void 0===d?[]:d,h=e.onSearchOptionsChange,E=void 0===h?function(){}:h,k=e.onAddTemplate,O=void 0===k?function(){}:k,x=e.onRemoveTemplate,N=void 0===x?function(){}:x,j=e.templatesCount,S=void 0===j?0:j,P=xc(te).state.tables,Z=(void 0===P?{}:P).current,_=L(Z),D=wc(!1),T=(0,g.Z)(D,2),I=T[0],A=T[1],q=wc(""),B=(0,g.Z)(q,2),F=B[0],M=B[1],R=Nc((function(){return Z?m.filter((function(e){var t=e.variable,n=e.field;return!!t&&!!n})).map((function(e){var t=e.variable,n=e.field,r=(0,ve.Z)(Z.fields).find((function(e){return e.name===n}));try{return{value:t,label:r.extend.caption}}catch(e){return{value:t,label:t}}})):[]}),[m,Z]);Oc((function(){Z&&Z!==_&&f(Z)}),[Z]);var V=Nc((function(){return Z?(0,ve.Z)(Z.fields).filter((function(e){return!e.extend.isHidden&&Cc.includes(e.type)})).sort((function(e,t){return e.extend.order-t.extend.order})).map((function(e){return{value:e.name,label:e.extend.caption}})):[]}),[Z]);return(0,v.createElement)(kc,null,I&&(0,v.createElement)(y.Spinner,null),(0,v.createElement)(y.Notify,{message:F,onClear:function(){return M(null)}}),(0,v.createElement)(ie,{type:"row align vertical space between",className:"fortressdb-block-title"},(0,v.createElement)(ie,null,"Custom Data"),(0,v.createElement)(ie,{type:"background contain",className:"fortressdb-logo fortressdb-block-logo"})),(0,v.createElement)(ie,{type:"row wrap"},(0,v.createElement)(ie,{className:"fortressdb-block-section",style:{marginRight:"1em",flexGrow:1}},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Data source"),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Table"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(In,{defaultSelected:s,onFetching:A,onError:M}))),(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Rows"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Input,{type:"number",value:n,onChange:function(e){var t=e.target.value;a(parseInt(t))}})))),(0,v.createElement)(ie,{className:"fortressdb-block-section",style:{flexGrow:1}},(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Search options"),(0,v.createElement)(ie,{type:"col relative",style:{maxWidth:"19em"}},(0,v.createElement)(y.Select,{isMulti:!0,isClearable:!0,options:V,value:V.filter((function(e){var t=e.value;return b.includes(t)})),onChange:function(e){E(e.map((function(e){return e.value})))}})),(0,v.createElement)(ie,{className:"fortressdb-block-section-title"},"Select field to copy to clipboard"),(0,v.createElement)(ie,{type:"col relative"},(0,v.createElement)(y.Select,{isMulti:!1,isClearable:!1,options:R,onChange:function(e){return t=e.value,void(0,w.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jc("${"+t+"}");case 2:case"end":return e.stop()}}),e)})))();var t}})))),(0,v.createElement)(ie,{type:"row wrap"},(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Get ID from URL"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Input,{type:"checkbox",disabled:S>1,checked:c,onChange:function(e){var t=e.target.checked;i(t)}})))),(0,v.createElement)(ie,{type:"row wrap"},(0,v.createElement)(ie,{type:"row wrap",className:"fortressdb-block-option"},(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-label"},"Alternate rows"),(0,v.createElement)(ie,{type:"col",className:"fortressdb-block-option-value"},(0,v.createElement)(y.Input,{type:"checkbox",checked:S>1,onChange:function(e){e.target.checked?O():N(1)}})))))}Sc.displayName="Toolbar";const Pc=window.wp.blocks,Zc=window.wp.data;function _c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_c(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Tc=E().useEffect,Ic=E().useState,Ac=E().useMemo,qc=E().useCallback,Bc=E().Fragment,Fc={0:"Even Rows",1:"Odd Rows"};function Mc(e){var t,n,r,a,o=e.attributes,c=e.setAttributes,l=(0,Zc.useDispatch)("core/block-editor"),i=l.replaceInnerBlocks,s=l.updateBlockAttributes,u=(0,fr.useBlockEditContext)().clientId,f=(0,Zc.useSelect)((function(e){return e("core/block-editor").getBlocks(u)}),[u]),p=o.tableName,m=Ic(o.rowCount||10),d=(0,g.Z)(m,2),b=d[0],y=d[1],h=Ic(o.columnCount||1),E=(0,g.Z)(h,2),w=E[0],k=E[1],O=Ic(null),x=(0,g.Z)(O,2),N=x[0],C=x[1],j=Ic(o.searchOptions||[]),S=(0,g.Z)(j,2),P=S[0],Z=S[1],_=Ic(o.isSingleItem||!1),D=(0,g.Z)(_,2),T=D[0],I=D[1],A=Ic((null==o||null===(t=o.theme)||void 0===t?void 0:t.pagination)||{}),q=(0,g.Z)(A,2),B=q[0],F=q[1],M=Ic((null==o||null===(n=o.theme)||void 0===n?void 0:n.search)||{}),R=(0,g.Z)(M,2),L=R[0],V=R[1],z=Ic((null==o||null===(r=o.theme)||void 0===r?void 0:r.labels)||{}),U=(0,g.Z)(z,2),H=U[0],W=U[1],J=Ic((null==o||null===(a=o.theme)||void 0===a?void 0:a.labelStyle)||"vertical"),Y=(0,g.Z)(J,2),K=Y[0],G=Y[1],$=Ic(Object.entries(o.variableMap||{}).map((function(e){var t=(0,g.Z)(e,2);return{variable:t[0],field:t[1]}}))),X=(0,g.Z)($,2),Q=X[0],ee=X[1],te=Ac((function(){return f.length}),[f]),ne=function(e){return Dc(Dc({},e),{},{title:Fc[e.index],parentId:u})};Tc((function(){if(N){var e=Q.filter((function(e){var t=e.variable,n=e.field;return t&&n})).reduce((function(e,t){var n=t.variable,r=t.field;return e[n]=r,e}),{});c(Dc(Dc({},o),{},{tableName:N.tableName,rowCount:b,columnCount:w,variableMap:e,searchOptions:P,isSingleItem:T,theme:{pagination:B,search:L,labelStyle:K,labels:H}}))}}),[N,b,w,Q,P,T,B,L,H,K]),Tc((function(){var e=f.length>1;f.map((function(t){var n=t.clientId;return s(n,{showHeader:e})}))}),[f]),Tc((function(){var e=Object.keys(o.blocks).length>0?o.blocks:{0:""},t=!1,n=Object.entries(e).map((function(e){var n=(0,g.Z)(e,2),r=n[0],a=n[1],o=ne({index:parseInt(r),closed:t});return t=!0,(0,Pc.createBlock)("fortressdb/custom-data-template",o,(0,Pc.parse)(a))}));i(u,n)}),[]);var re=qc((function(e){return V(e)}),[]),ae=qc((function(e){return W(e)}),[]),oe=qc((function(e){return G(e)}),[]);return(0,v.createElement)("div",{className:"fortressdb-edit-block"},(0,v.createElement)(fr.InspectorControls,null,(0,v.createElement)(Ec,{variableMap:Q,table:N,onChange:ee}),!gc()(P)&&(0,v.createElement)(Bc,null,(0,v.createElement)(Er,{theme:L,onChange:re}),(0,v.createElement)(Lr,{tableFields:(N||{fields:[]}).fields.filter((function(e){var t=e.name;return!!P.includes(t)})),labels:H,labelStyle:K,onChange:ae,onLabelStyleChange:oe})),(0,v.createElement)(vr,{theme:B,onChange:F})),(0,v.createElement)(Sc,{tableName:p,rowCount:b,onRowCountChange:y,columnCount:w,onColumnCountChange:k,onTableChange:function(e){if(C(e),(!N||N.id!==e.id)&&(gc()(Q)||null!==N)){var t=["createdAt","updatedAt"],n=(0,ve.Z)(e.fields).filter((function(e){return!e.extend.isHidden&&!t.includes(e.name)})).reduce((function(e,t){var n=(t.extend.caption||t.name).replace(/[^a-zA-Z0-9_\s]/gim,"").replace(/\s+/g,"_").toLowerCase();return e.push({variable:n,field:t.name}),e}),[]);ee(n)}},variableMap:Q,searchOptions:P,onSearchOptionsChange:Z,isSingleItem:T,onIsSingleItemChange:I,onAddTemplate:function(){var e=(0,Pc.createBlock)("fortressdb/custom-data-template",ne({index:1}),[]);i(u,[].concat((0,ve.Z)(f),[e])),I(!1)},onRemoveTemplate:function(e){i(u,(0,ve.Z)(f).filter((function(t){return t.attributes.index!==e})));var t=Dc({},o.blocks);delete t[e],c({blocks:t})},templatesCount:te}),(0,v.createElement)(fr.InnerBlocks,{renderAppender:!1,allowedBlocks:["fortressdb/custom-data-template"]}))}function Rc(e){return(0,v.createElement)("div",{className:"fortressdb-block fortressdb-block_edit fortressdb-block_merge"},(0,v.createElement)(ee,null,(0,v.createElement)(ne,null,(0,v.createElement)(Mc,e))))}Mc.displayName="EditForm",Rc.displayName="Edit";var Lc="fortressdb-block-custom-data",Vc=n.g.wp;function zc(e){var t=e.attributes,n=Vc.blocks,r=n.getSaveContent,a=n.parse,o=n.cloneBlock,c={},l=["blocks"],i=function e(t){var n=t.innerBlocks.map(e);return o(t,function(e){return e.attributes.fdb_block&&"core/image"===e.name?{url:e.attributes.fdb_field}:{}}(t),n)};Object.entries(t.blocks).map((function(e){var t=(0,g.Z)(e,2),n=t[0],o=t[1],l=a(o).map((function(e){var t=i(e);return r(t.name,t.attributes,t.innerBlocks)})).join("\n\n");c[n]=btoa(l)})),t.templates=c;var s=Object.keys(t).filter((function(e){return!l.includes(e)})).reduce((function(e,n){return e[n]=t[n],e}),{});return(0,v.createElement)("div",{className:Lc,"data-attributes":JSON.stringify(s)})}function Uc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uc(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wc(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Jc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jc(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function Jc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}zc.displayName="Save";var Yc=E().useEffect,Kc=E().useState,Gc=E().useMemo,$c=n(5664),Xc={},Qc=function(){var e=(0,w.Z)(C().mark((function e(t,n,r,a){var o,c,l,i,s,u,f,p,m;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o={},c=[],l=0,i=Object.entries(a);l<i.length;l++)s=(0,g.Z)(i[l],2),u=s[0],f=s[1],p=n[f],m=t[f],function(){switch(p.type){case"enum":var e=m?Array.isArray(m)?m:[m]:[],t=r[p.extend.enumId]||{};m=e.map((function(e){return t[e]||e})).join(", ");break;case"datetime":m=P(m);break;case"json":m=JSON.stringify(m);break;case"file":if(!m){m="".concat(fortressdbStaticUrl,"/build/").concat($c);break}m.length>0?(m=m[0],void 0!==Xc[m.uuid]?m=Xc[m.uuid]:(c.push({variable:u,value:m}),m="".concat(fortressdbStaticUrl,"/build/").concat($c))):m="".concat(fortressdbStaticUrl,"/build/").concat($c)}}(),o[u]=m;return e.abrupt("return",{data:o,files:c});case 4:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}();function el(e){var t=e.template,n=e.entry,r=e.tableFields,a=e.enumValues,o=e.variableMap,c=Kc({}),l=(0,g.Z)(c,2),i=l[0],s=l[1],u=Kc([]),f=(0,g.Z)(u,2),p=f[0],m=f[1],d=Kc(""),b=(0,g.Z)(d,2),y=b[0],h=b[1];return Yc((function(){(0,w.Z)(C().mark((function e(){var t,c,l;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qc(n,r,a,o);case 2:t=e.sent,c=t.data,l=t.files,s(c),m(l);case 7:case"end":return e.stop()}}),e)})))()}),[n]),Yc((function(){p.length<=0||(0,w.Z)(C().mark((function e(){var t,n,r,a,o,c;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={},n=Wc(p),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=17;break}if(a=r.value,o=a.variable,c=a.value,void 0===Xc[c.uuid]){e.next=11;break}t[o]=Xc[c.uuid],e.next=15;break;case 11:return e.next=13,(0,I.q)(c,"thumb");case 13:t[o]=e.sent,Xc[c.uuid]=t[o];case 15:e.next=4;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2),n.e(e.t0);case 22:return e.prev=22,n.f(),e.finish(22);case 25:s(Hc(Hc({},i),t));case 26:case"end":return e.stop()}}),e,null,[[2,19,22,25]])})))()}),[p]),Yc((function(){gc()(i)||h(function(e,t){for(var n=0,r=Object.entries(t);n<r.length;n++){var a=(0,g.Z)(r[n],2),o=a[0],c=a[1];e=e.replaceAll("${"+o+"}",c)}return e}(t,i))}),[i]),(0,v.createElement)("div",{dangerouslySetInnerHTML:{__html:y}})}function tl(e){var t=e.attributes,n=t.tableName,r=t.rowCount,a=t.columnCount,o=t.searchOptions,c=void 0===o?[]:o,l=t.variableMap,i=t.isSingleItem,s=t.theme,u=void 0===s?{}:s,f=Object.entries(e.attributes.templates||{}).reduce((function(e,t){var n=(0,g.Z)(t,2),r=n[0],a=n[1];return e[r]=atob(a),e}),{}),p=Kc(null),m=(0,g.Z)(p,2),d=(m[0],m[1]),b=Kc(null),y=(0,g.Z)(b,2),h=y[0],E=y[1],k=Kc(null),O=(0,g.Z)(k,2),x=O[0],N=O[1],S=Kc(null),P=(0,g.Z)(S,2),Z=P[0],_=P[1],D=Kc(0),T=(0,g.Z)(D,2),I=T[0],A=T[1],q=Kc(0),B=(0,g.Z)(q,2),M=B[0],R=B[1],L=Kc([]),V=(0,g.Z)(L,2),z=V[0],U=V[1],H=parseInt(new URL(document.location.href).searchParams.get("id")),W=Object.keys(f),J={limit:i?1:r*a,offset:0,order:[j.query.orderBy("id",j.query.ASC)]};i&&(J.where=j.query.op("=","id",j.query.val(H)));var Y=Kc(J),K=(0,g.Z)(Y,2),G=K[0],$=K[1];Yc((function(){(0,w.Z)(C().mark((function e(){var t,r,a,o,c,l;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.W.get("metadata",{filter:{where:j.query.op("=","tableName",j.query.val(n))}});case 3:if(1===(t=e.sent).count){e.next=6;break}throw new Error("Table not found");case 6:return r=t.rows.find((function(e){return e.tableName===n})),a=r.fields.reduce((function(e,t){return e[t.name]=t,e}),{}),N(r),E(a),o=r.fields.filter((function(e){return"enum"===e.type})).map((function(e){return e.extend.enumId})),e.next=13,F.W.get("enum_values",{context:{enumId:o}});case 13:c=e.sent,l=Object.keys(c).reduce((function(e,t){return e[t]=c[t].rows.reduce((function(e,t){return e[t.id]=t.label,e}),{}),e}),{}),_(l),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.error("Metadata fetch:",e.t0,n),d(e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,18]])})))()}),[n]),Yc((function(){null!==h&&null!==Z&&(0,w.Z)(C().mark((function e(){var t,r,a,o,c;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Hc(Hc({},G),{},{attributes:Object.values(l||{})}),r={context:{tableName:n},filter:t},e.prev=2,e.next=5,F.W.get("objects",r);case 5:a=e.sent,o=a.count,c=a.rows,R(o),U(c),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))()}),[G,Z]),Yc((function(){$(Hc(Hc({},G),{},{offset:i?0:I*a*r}))}),[I]);var X=function(e){var t=e%W.length,n=W[t];return f[n]};if(i&&!H)return(0,v.createElement)("div",null);var Q=Gc((function(){return Z?Object.entries(Z).reduce((function(e,t){var n=(0,g.Z)(t,2),r=n[0],a=n[1];return e[r]=Object.entries(a).map((function(e){var t=(0,g.Z)(e,2);return{id:t[0],label:t[1]}})),e}),{}):{}}),[Z]);return(0,v.createElement)("div",{className:"fortressdb-custom-data-block-view"},!i&&c.length>0&&(0,v.createElement)(wr.Provider,{value:u.search||yr},(0,v.createElement)(Br,{type:u.labelStyle,labels:u.labels||{},table:x,searchableFields:c,enumValues:Q,onChange:function(e){var t=Object.entries(e).filter((function(e){var t=(0,g.Z)(e,2),n=t[0],r=t[1];return n&&!gc()(r)})).map((function(e){var t=(0,g.Z)(e,2),n=t[0],r=t[1],a=h[n]||null;if(!a)return null;var o=a.type,c=a.name;return"text"===o||"string"===o?j.query.op("iLike",c,j.query.val("%".concat(r,"%"))):"enum"===o?j.query.op("contains",c,j.query.val(r.map((function(e){return parseInt(e)})))):null})).filter((function(e){return!!e})),n={};t.length&&(n=1===t.length?t[0]:j.query.op.apply(j.query,["and"].concat((0,ve.Z)(t))));var r=Hc(Hc({},G),{},{page:0,where:n});gc()(n)&&delete r.where,$(r),A(0)}})),z.map((function(e,t){return(0,v.createElement)(el,{key:t,template:X(t),entry:e,tableFields:h,enumValues:Z,variableMap:l})})),!i&&(0,v.createElement)(or.Provider,{value:u.pagination||ar},(0,v.createElement)(ur,{page:I,totalObjects:M,perPage:r*a,onPageChange:function(e){return A(e)}})))}function nl(){return(0,v.createElement)("div",{className:"placeholder"},(0,v.createElement)("div",{className:"text"},"Insert your template here."))}function rl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function al(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rl(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}el.displayName="Element",tl.displayName="View",nl.displayName="Placeholder";var ol=E().useEffect,cl=E().useState,ll=E().Fragment,il=["core/paragraph","core/table","core/heading","core/columns","core/image"];function sl(e){var t=e.attributes,n=t.parentId,r=t.index,a=t.showHeader,o=t.title,c=(0,Zc.useDispatch)("core/block-editor").updateBlockAttributes,l=(0,fr.useBlockEditContext)().clientId,i=(0,Zc.useSelect)((function(e){return e("core/block-editor").getBlocks(l)}),[l]),s=(0,Zc.useSelect)((function(e){return(0,e("core/block-editor").getBlockAttributes)(n)}),[n]),f=cl(t.closed),p=(0,g.Z)(f,2),m=p[0],d=p[1];return ol((function(){c(n,{blocks:al(al({},s.blocks),(0,u.Z)({},r,(0,Pc.serialize)(i)))})}),[i]),(0,v.createElement)("div",{className:"fortressdb-custom-data-template"},a&&(0,v.createElement)("div",{className:"header"},(0,v.createElement)("span",null,o),(0,v.createElement)(Fr.Icon,{icon:m?"arrow-down":"arrow-up",className:"icon",onClick:function(){return d(!m)}})),!m&&(0,v.createElement)(ll,null,0===i.length&&(0,v.createElement)(nl,null),(0,v.createElement)(fr.InnerBlocks,{renderAppender:function(){return(0,v.createElement)(fr.InnerBlocks.ButtonBlockAppender,null)},allowedBlocks:il})))}function ul(){return null}sl.displayName="Edit",Gr(ia,ba),Gr(Aa,Va),Gr(Xa,No),Gr(nc,vc),Gr(Lc,tl);var fl={url:n(9187).q,download:n(312).S}},2361:(e,t,n)=>{n.d(t,{F:()=>m});var r=n(5671),a=n(3144),o=n(4942),c=n(5716);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s=JSON.stringify,u=n.g.fortressdbNonce,f=n.g.ajaxurl,p=void 0===f?"/wp-admin/admin-ajax.php":f,m=function(){function e(t){(0,r.Z)(this,e),this.name=t}return(0,a.Z)(e,[{key:"url",value:function(){return"".concat(p,"?action=").concat("fortressdb_api_backend","&nonce=").concat(u)}},{key:"getCurlPayload",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i(i({_method:e.toUpperCase(),_name:this.name},"auth/subscribe"===this.name?{_visitor:session.visitorId}:{}),t);return n}},{key:"request",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i({_method:t,_name:this.name},n);e.accessToken&&(r._accessToken=e.accessToken);var a=new c.a(this.url(),{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},body:s(r)});return a}},{key:"get",value:function(e){return this.request("GET",e)}},{key:"post",value:function(e){return this.request("POST",e)}},{key:"put",value:function(e){return this.request("PUT",e)}},{key:"delete",value:function(e){return this.request("DELETE",e)}}]),e}();(0,o.Z)(m,"accessToken","")},5716:(e,t,n)=>{n.d(t,{a:()=>r.HttpRequest});var r=n(9470)},312:(e,t,n)=>{n.d(t,{S:()=>c});var r=n(2092),a=n(9470),o=n.g.fortressdbBackendUrl;function c(e,t,n){return r.W.authenticate().then((function(r){var c=r.socket;return a.FileUtils.download(o,c.signedAuthToken,e,t,n)}))}},9187:(e,t,n)=>{n.d(t,{q:()=>c});var r=n(2092),a=n(9470),o=n.g.fortressdbBackendUrl;function c(e,t,n){return r.W.authenticate().then((function(r){var c=r.socket;return a.FileUtils.getUrl(o,c.signedAuthToken,e,t,n)}))}},2092:(e,t,n)=>{n.d(t,{W:()=>f});var r=n(4942),a=n(2361),o=n(9470);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var i=n.g,s=i.fortressdbSocketOptions,u=i.fortressdbInitialOptions,f=new o.Socket(l(l({},s||{}),{},{client:function(){return delete a.F.accessToken,new a.F("auth/subscribe").post().json()},storageName:"fortressdb_data",verify:function(){return u.userId===f.storage.getItem("userId")},onAuthenticate:function(){f.storage.setItem("userId",u.userId)}}))},5664:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=n.p+"assets/c050fe7d1294aa622cdb70aee1acb431.png"},9470:t=>{t.exports=e},4076:e=>{e.exports=t},9196:e=>{e.exports=window.React},1850:e=>{e.exports=window.ReactDOM}},a={};function o(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return r[e](n,n.exports,o),n.loaded=!0,n.exports}o.m=r,n=[],o.O=(e,t,r,a)=>{if(!t){var c=1/0;for(u=0;u<n.length;u++){for(var[t,r,a]=n[u],l=!0,i=0;i<t.length;i++)(!1&a||c>=a)&&Object.keys(o.O).every((e=>o.O[e](t[i])))?t.splice(i--,1):(l=!1,a<c&&(c=a));if(l){n.splice(u--,1);var s=r();void 0!==s&&(e=s)}}return e}a=a||0;for(var u=n.length;u>0&&n[u-1][2]>a;u--)n[u]=n[u-1];n[u]=[t,r,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={747:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,a,[c,l,i]=n,s=0;if(c.some((t=>0!==e[t]))){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(i)var u=i(o)}for(t&&t(n);s<c.length;s++)a=c[s],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(u)},n=self.webpackChunkfortressdb=self.webpackChunkfortressdb||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var c=o.O(void 0,[673],(()=>o(4534)));return o.O(c)})()}));